{"paragraphs":[{"text":"%md\n## MMOD: Lab2 Генерация систем непрерывных и дискретных случайных величин.","user":"anonymous","dateUpdated":"2019-10-28T14:51:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>MMOD: Lab2 Генерация систем непрерывных и дискретных случайных величин.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1572274065152_-56096433","id":"20191028-144745_540533318","dateCreated":"2019-10-28T14:47:45+0000","dateStarted":"2019-10-28T14:51:14+0000","dateFinished":"2019-10-28T14:51:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:262"},{"text":"%md\n### Preparing util functions","user":"anonymous","dateUpdated":"2019-10-28T15:11:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Preparing util functions</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1572275471670_92382771","id":"20191028-151111_21295236","dateCreated":"2019-10-28T15:11:11+0000","dateStarted":"2019-10-28T15:11:28+0000","dateFinished":"2019-10-28T15:11:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:263"},{"text":"import org.joda.time.DateTime\n\nclass LinearCongruentGenerator(m: BigInt = BigInt(\"34359738368\"),\n                               k: BigInt = BigInt(\"152587890625\"),\n                               A0: BigInt = 9999) extends Serializable {\n\n  var prevValue: BigInt = A0\n\n  def next: Double = {\n    val result: BigInt = (k * prevValue) % m\n    prevValue = result\n    result.toDouble / m.toDouble\n  }\n}\n\nval random = new LinearCongruentGenerator(A0 = new DateTime().getMillis / 1000)","user":"anonymous","dateUpdated":"2019-10-28T15:11:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: Class org.joda.convert.FromString not found - continuing with a stub.\nwarning: Class org.joda.convert.ToString not found - continuing with a stub.\nwarning: Class org.joda.convert.ToString not found - continuing with a stub.\nwarning: Class org.joda.convert.FromString not found - continuing with a stub.\nwarning: Class org.joda.convert.ToString not found - continuing with a stub.\nimport org.joda.time.DateTime\ndefined class LinearCongruentGenerator\nrandom: LinearCongruentGenerator = LinearCongruentGenerator@170681d\n"}]},"apps":[],"jobName":"paragraph_1572275490775_-1635354932","id":"20191028-151130_538298336","dateCreated":"2019-10-28T15:11:30+0000","dateStarted":"2019-10-28T15:11:35+0000","dateFinished":"2019-10-28T15:11:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:264"},{"text":"%md\n## Part 1.","user":"anonymous","dateUpdated":"2019-10-28T14:51:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Part 1.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1572274266625_255453311","id":"20191028-145106_1173970613","dateCreated":"2019-10-28T14:51:06+0000","dateStarted":"2019-10-28T14:51:54+0000","dateFinished":"2019-10-28T14:51:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:265"},{"text":"def f(x: Double, y: Double) = (3 / (8 * scala.math.Pi)) * (2 - scala.math.pow(x * x + y * y, 0.5))\n\ndef partialDerivativeOnX(x: Double, y: Double) = -(3 / (8 * scala.math.Pi)) * (x / scala.math.pow(x * x + y * y, 0.5))\n\ndef partialDerivativeOnY(x: Double, y: Double) = -(3 / (8 * scala.math.Pi)) * (y / scala.math.pow(x * x + y * y, 0.5))\n\ndef cpy(x: Double) = (y: Double) => partialDerivativeOnX(x, y)\n\ndef cpx(y: Double) = (x: Double) => partialDerivativeOnX(x, y)","user":"anonymous","dateUpdated":"2019-10-28T15:08:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"f: (x: Double, y: Double)Double\npartialDerivativeOnX: (x: Double, y: Double)Double\npartialDerivativeOnY: (x: Double, y: Double)Double\ncpy: (x: Double)Double => Double\ncpx: (y: Double)Double => Double\n"}]},"apps":[],"jobName":"paragraph_1572274314329_1232951720","id":"20191028-145154_1417297029","dateCreated":"2019-10-28T14:51:54+0000","dateStarted":"2019-10-28T15:08:04+0000","dateFinished":"2019-10-28T15:08:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:266"},{"text":"import scala.annotation.tailrec\n\n@tailrec\nfinal def getSampleFromAtoB(from: Double, to: Double, probabilityFunction: Double => Double, r: LinearCongruentGenerator): Double = {\n    val r1 = r.next\n    val r2 = r.next\n    val x = from + (to - from) * r1\n    val pfMaxValue = probabilityFunction(0) // using some cheats for now :)\n    if (r2 * pfMaxValue < probabilityFunction(x)) x\n    else getSampleFromAtoB(from, to, probabilityFunction, r)\n}","user":"anonymous","dateUpdated":"2019-10-28T15:21:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.annotation.tailrec\ngetSampleFromAtoB: (from: Double, to: Double, probabilityFunction: Double => Double, r: LinearCongruentGenerator)Double\n"}]},"apps":[],"jobName":"paragraph_1572275423485_769397042","id":"20191028-151023_698055291","dateCreated":"2019-10-28T15:10:23+0000","dateStarted":"2019-10-28T15:21:20+0000","dateFinished":"2019-10-28T15:21:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:267"},{"text":"import scala.collection.mutable.ArrayBuffer\n\n@tailrec\nfinal def GibbsSampling(xPrev: Double, \n                        yPrev: Double, \n                        from: Double, \n                        to: Double, \n                        cpx: Double => Double => Double, \n                        cpy: Double => Double => Double, \n                        arr: ArrayBuffer[(Double, Double)],\n                        r: LinearCongruentGenerator,\n                        i: Int): ArrayBuffer[(Double, Double)] = {\n    if(i == 0) arr\n    else {\n        val x = getSampleFromAtoB(from, to, cpx(yPrev), r)\n        val y = getSampleFromAtoB(from, to, cpy(x), r)\n        GibbsSampling(x, y, from, to, cpx, cpy, arr += Tuple2(x, y), r, i - 1)\n    }\n}","user":"anonymous","dateUpdated":"2019-10-28T15:31:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.collection.mutable.ArrayBuffer\nGibbsSampling: (xPrev: Double, yPrev: Double, from: Double, to: Double, cpx: Double => (Double => Double), cpy: Double => (Double => Double), arr: scala.collection.mutable.ArrayBuffer[(Double, Double)], r: LinearCongruentGenerator, i: Int)scala.collection.mutable.ArrayBuffer[(Double, Double)]\n"}]},"apps":[],"jobName":"paragraph_1572274709127_500790438","id":"20191028-145829_1557467497","dateCreated":"2019-10-28T14:58:29+0000","dateStarted":"2019-10-28T15:30:04+0000","dateFinished":"2019-10-28T15:30:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:268"},{"text":"val (x0, y0) = (0.0, 0.0)\n\nval sample = GibbsSampling(x0, y0, -2, 2, cpx, cpy, ArrayBuffer.empty[(Double, Double)], new LinearCongruentGenerator(A0 = new DateTime().getMillis / 1000), 10)","user":"anonymous","dateUpdated":"2019-10-28T15:33:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1572276534218_793194936","id":"20191028-152854_2107532773","dateCreated":"2019-10-28T15:28:54+0000","dateStarted":"2019-10-28T15:33:33+0000","dateFinished":"2019-10-28T15:33:11+0000","status":"RUNNING","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:269"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1572276791390_-1077063931","id":"20191028-153311_646582623","dateCreated":"2019-10-28T15:33:11+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:270"}],"name":"MMOD: Lab2","id":"2ERUJQFH8","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}