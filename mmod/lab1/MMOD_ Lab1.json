{"paragraphs":[{"text":"%md\n## MMOD: Lab1 Базовая случайная величина. Генерация непрерывных и дискретных случайных величин.","user":"anonymous","dateUpdated":"2019-10-22T16:31:02+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>MMOD: Lab1 Базовая случайная величина. Генерация непрерывных и дискретных случайных величин.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257233_-560518086","id":"20191012-160955_881587067","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:02+0000","dateFinished":"2019-10-22T16:31:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10558"},{"text":"%md\n### Preparing util functions","user":"anonymous","dateUpdated":"2019-10-22T16:31:02+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Preparing util functions</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257234_1924535919","id":"20191012-161356_135676605","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:02+0000","dateFinished":"2019-10-22T16:31:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10559"},{"text":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\nimport org.joda.time.DateTime\n\nclass LinearCongruentGenerator(m: BigInt = BigInt(\"34359738368\"),\n                               k: BigInt = BigInt(\"152587890625\"),\n                               A0: BigInt = 9999) extends Serializable {\n\n  var prevValue: BigInt = A0\n\n  def next: Double = {\n    val result: BigInt = (k * prevValue) % m\n    prevValue = result\n    result.toDouble / m.toDouble\n  }\n}\n\nval random = new LinearCongruentGenerator(A0 = new DateTime().getMillis / 1000)\n\ndef randomDf(range: Int, random: LinearCongruentGenerator, columnName: String = \"value\") = {\n    spark.createDataFrame(\n        spark.sparkContext.parallelize((0 until range).map(i => random.next)).map(t => Row(t)), \n        StructType(\n            Seq(\n                StructField(columnName, DataTypes.DoubleType, false)\n            )\n        )\n    )\n}\n\ndef average(arr: Array[Double]): Double = arr.sum / arr.length\n\ndef mean(arr: Array[Double]): Double = average(arr)\n\ndef variance(arr: Array[Double]): Double = {\n    val sEV = average(arr)\n    average(arr.map(i => scala.math.pow(i - sEV, 2)))\n}\n\ndef median(arr: Array[Double]): Double = {\n    val sorted = arr.sortWith(_ < _)\n    if (sorted.length % 2 == 0) (arr(sorted.length / 2) + arr(sorted.length / 2 - 1)) / 2\n    else arr(sorted.length / 2)\n}\n\ndef mode(arr: Array[Double], interval: Double): Double = {\n    val intervalNumber = arr.groupBy(value => (value / interval).toInt).mapValues(_.size).maxBy(_._2)._1\n    (intervalNumber * interval + (intervalNumber + 1) * interval) / 2\n}","user":"anonymous","dateUpdated":"2019-10-22T16:31:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\nimport org.joda.time.DateTime\ndefined class LinearCongruentGenerator\nrandom: LinearCongruentGenerator = LinearCongruentGenerator@406d8113\nrandomDf: (range: Int, random: LinearCongruentGenerator, columnName: String)org.apache.spark.sql.DataFrame\naverage: (arr: Array[Double])Double\nmean: (arr: Array[Double])Double\nvariance: (arr: Array[Double])Double\nmedian: (arr: Array[Double])Double\nmode: (arr: Array[Double], interval: Double)Double\n"}]},"apps":[],"jobName":"paragraph_1571069257234_-364478169","id":"20191001-084552_364857475","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:02+0000","dateFinished":"2019-10-22T16:31:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10560"},{"text":"%md\n### Lets calculate interval statistics with Bootstrap method","user":"anonymous","dateUpdated":"2019-10-22T16:31:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Lets calculate interval statistics with Bootstrap method</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571233225613_1807967391","id":"20191016-134025_630493356","dateCreated":"2019-10-16T13:40:25+0000","dateStarted":"2019-10-22T16:31:03+0000","dateFinished":"2019-10-22T16:31:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10561"},{"text":"import scala.collection.mutable.ArrayBuffer\n\n\ndef generateSample(arr: Array[Double], n: Int): Array[Double] = {\n    val buf = new ArrayBuffer[Double]()\n    (0 until n).foreach(i => buf += arr((n * random.next).toInt))\n    buf.toArray\n}\n\ndef calcIntervalStatistic(arr: Array[Double], m: Int, statistic: Array[Double] => Double): (Double, Double) = {\n    val point_stat = statistic(arr)\n    \n    val samples = (0 to m).map(i => generateSample(arr, arr.length))\n    val statistics = samples.map(statistic).toArray\n    val S2 = variance(statistics)\n    val s = scala.math.pow(S2, 0.5)\n    (point_stat - s, point_stat + s)\n}","user":"anonymous","dateUpdated":"2019-10-22T16:31:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.collection.mutable.ArrayBuffer\ngenerateSample: (arr: Array[Double], n: Int)Array[Double]\ncalcIntervalStatistic: (arr: Array[Double], m: Int, statistic: Array[Double] => Double)(Double, Double)\n"}]},"apps":[],"jobName":"paragraph_1571233260023_-1806432002","id":"20191016-134100_492875556","dateCreated":"2019-10-16T13:41:00+0000","dateStarted":"2019-10-22T16:31:03+0000","dateFinished":"2019-10-22T16:31:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10562"},{"text":"%md \n### Pearson's chi-squared criteria:","user":"anonymous","dateUpdated":"2019-10-22T16:31:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Pearson&rsquo;s chi-squared criteria:</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571240900949_-1945973797","id":"20191016-154820_656001612","dateCreated":"2019-10-16T15:48:20+0000","dateStarted":"2019-10-22T16:31:03+0000","dateFinished":"2019-10-22T16:31:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10563"},{"text":"import breeze.stats.distributions.ChiSquared\n\n// b2 - вероятность ошибки второго рода, то есть что примем неверную\ndef calcXi2(df: org.apache.spark.sql.DataFrame, M: Double, F: Double => Double, S: Int, b2: Double): (Double, Double, Boolean) = {\n    val N = df.count.toDouble\n    val (a, b) = (df.select(min('value)).first.getDouble(0), df.select(max('value)).first.getDouble(0))\n    val interval = (b - a) / M\n    val groupedDf = df.withColumn(\"int_id\", (('value - a) / interval).cast(IntegerType)).filter('int_id < M).groupBy('int_id).agg((count(\"*\") / N).as(\"pi_\"))\n    \n    print(a, b, interval)\n    z.show(groupedDf)\n    \n    def p(i: Int) = F(a + interval * (i + 1)) - F(a + interval * i)\n    val pi = udf(p(_:Int):Double) // Creating udf that will calculate difference of distribution function on ends of i'th interval\n    \n    val chi2 = N * groupedDf.agg(sum(pow('pi_ - pi('int_id), 2) / pi('int_id))).first.getDouble(0)\n    val boundaryValue = ChiSquared(M - S - 1).inverseCdf(1 - b2)\n    \n    (chi2, boundaryValue, chi2 < boundaryValue)\n}","user":"anonymous","dateUpdated":"2019-10-22T16:31:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import breeze.stats.distributions.ChiSquared\ncalcXi2: (df: org.apache.spark.sql.DataFrame, M: Double, F: Double => Double, S: Int, b2: Double)(Double, Double, Boolean)\n"}]},"apps":[],"jobName":"paragraph_1571240954131_1587090153","id":"20191016-154914_1954526450","dateCreated":"2019-10-16T15:49:14+0000","dateStarted":"2019-10-22T16:31:04+0000","dateFinished":"2019-10-22T16:31:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10564"},{"text":"%md\n## Part 1.","user":"anonymous","dateUpdated":"2019-10-22T16:31:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Part 1.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1571233294171_1523378599","id":"20191016-134134_1083037282","dateCreated":"2019-10-16T13:41:34+0000","dateStarted":"2019-10-22T16:31:04+0000","dateFinished":"2019-10-22T16:31:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10565"},{"text":"%md\n### Constants","user":"anonymous","dateUpdated":"2019-10-22T16:31:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Constants</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257235_140599765","id":"20191012-161504_1431968683","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:04+0000","dateFinished":"2019-10-22T16:31:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10566"},{"text":"val N = 1000000 // Sample size\nval M = 20 // Bins count","user":"anonymous","dateUpdated":"2019-10-22T16:31:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"N: Int = 1000000\nM: Int = 20\n"}]},"apps":[],"jobName":"paragraph_1571069257235_-1058768338","id":"20191012-161716_1721258311","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:04+0000","dateFinished":"2019-10-22T16:31:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10567"},{"text":"%md\n### Creating a sample","user":"anonymous","dateUpdated":"2019-10-22T16:31:05+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Creating a sample</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257235_-628873443","id":"20191012-161737_1519390953","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:05+0000","dateFinished":"2019-10-22T16:31:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10568"},{"text":"val df = randomDf(N, random)\ndf.show(10)","user":"anonymous","dateUpdated":"2019-10-22T16:31:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+\n|              value|\n+-------------------+\n|0.12132368257152848|\n|0.44660636244225316|\n| 0.7676326746295672|\n| 0.5526109321217518|\n| 0.7731674166570883|\n| 0.6855963787238579|\n| 0.6121100375603419|\n| 0.7220885811548214|\n| 0.8133301662455779|\n|0.09330091832089238|\n+-------------------+\nonly showing top 10 rows\n\ndf: org.apache.spark.sql.DataFrame = [value: double]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=132"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257235_-1442612764","id":"20191012-144505_885667887","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:05+0000","dateFinished":"2019-10-22T16:31:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10569"},{"text":"%md\n### Drawing histogram with M bins","user":"anonymous","dateUpdated":"2019-10-22T16:31:06+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Drawing histogram with M bins</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257236_-1965284583","id":"20191012-161826_232387597","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:06+0000","dateFinished":"2019-10-22T16:31:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10570"},{"text":"import org.apache.spark.sql.types.IntegerType\nz.show(df.withColumn(\"int_id\", ('value * M).cast(IntegerType)).groupBy(\"int_id\").agg((count(\"*\") / N).as(\"p\")))","user":"anonymous","dateUpdated":"2019-10-22T17:14:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"int_id":"string","p":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"int_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"p","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"int_id\tp\n12\t0.050002\n1\t0.049827\n13\t0.050008\n16\t0.049889\n6\t0.049984\n3\t0.049954\n5\t0.049979\n19\t0.050032\n15\t0.050108\n17\t0.050039\n9\t0.049684\n4\t0.049677\n8\t0.050116\n7\t0.049935\n10\t0.050052\n11\t0.05\n14\t0.05024\n2\t0.050244\n0\t0.049819\n18\t0.050411\n"},{"type":"TEXT","data":"import org.apache.spark.sql.types.IntegerType\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=133","http://172.17.0.2:4040/jobs/job?id=134","http://172.17.0.2:4040/jobs/job?id=135","http://172.17.0.2:4040/jobs/job?id=136","http://172.17.0.2:4040/jobs/job?id=137"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257236_-389029586","id":"20191001-085208_579427695","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:06+0000","dateFinished":"2019-10-22T16:31:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10571"},{"text":"%md\n### Calculating pointed Mean and Variance","user":"anonymous","dateUpdated":"2019-10-22T16:31:07+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating pointed Mean and Variance</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257236_492361184","id":"20191012-163117_1936812781","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:07+0000","dateFinished":"2019-10-22T16:31:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10572"},{"text":"val EV = df.agg(avg('value)).first.getDouble(0)\nval EV2 = scala.math.pow(EV, 2)\nval D = df.agg(avg(pow('value, 2) - EV2)).first.getDouble(0)","user":"anonymous","dateUpdated":"2019-10-22T16:31:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"EV: Double = 0.5004386769510223\nEV2: Double = 0.25043886938848964\nD: Double = 0.08336658115500188\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=138","http://172.17.0.2:4040/jobs/job?id=139"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257237_-1582872723","id":"20191001-093930_847132398","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:08+0000","dateFinished":"2019-10-22T16:31:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10573"},{"text":"%md\n### Calculating interval Mean and Variance","user":"anonymous","dateUpdated":"2019-10-22T16:31:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating interval Mean and Variance</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257237_1786248277","id":"20191013-172239_763410667","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:09+0000","dateFinished":"2019-10-22T16:31:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10574"},{"text":"calcIntervalStatistic(df.collect.map(_.getDouble(0)), 10, mean)","user":"anonymous","dateUpdated":"2019-10-22T16:31:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res57: (Double, Double) = (0.5002238171657762,0.5006535367362683)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=140"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571232877947_-1963489669","id":"20191016-133437_1431946506","dateCreated":"2019-10-16T13:34:37+0000","dateStarted":"2019-10-22T16:31:09+0000","dateFinished":"2019-10-22T16:31:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10575"},{"text":"calcIntervalStatistic(df.collect.map(_.getDouble(0)), 10, variance)","user":"anonymous","dateUpdated":"2019-10-22T16:31:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res58: (Double, Double) = (0.08328510186843291,0.08344806046931239)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=141"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571233599483_1462857979","id":"20191016-134639_166229228","dateCreated":"2019-10-16T13:46:39+0000","dateStarted":"2019-10-22T16:31:18+0000","dateFinished":"2019-10-22T16:31:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10576"},{"text":"%md \n### Calculating correlation","user":"anonymous","dateUpdated":"2019-10-22T16:31:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating correlation</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257238_1886595107","id":"20191013-170034_865274919","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:25+0000","dateFinished":"2019-10-22T16:31:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10577"},{"text":"val df2 = randomDf(N, random, \"value2\") // Generating a second one sample\ndf2.show\n\nval dfid = df.withColumn(\"id\", monotonically_increasing_id)\nval dfid2 = df2.withColumn(\"id\", monotonically_increasing_id)\n\nval joined = dfid.join(dfid2, dfid.col(\"id\") === dfid2.col(\"id\"))\nval R = joined.agg((avg('value * 'value2) * 12) - 3).first.getDouble(0)","user":"anonymous","dateUpdated":"2019-10-22T16:31:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+\n|             value2|\n+-------------------+\n| 0.6432037132035475|\n| 0.8967777138750535|\n| 0.7042008156131487|\n| 0.8149313314061146|\n|0.48184554299223237|\n|0.24248770085978322|\n| 0.7003200242470484|\n|0.30597270114230923|\n| 0.1384938882838469|\n| 0.6865997111599427|\n| 0.6299242640088778|\n| 0.6202696098189335|\n|0.06285578032839112|\n| 0.8975707760255318|\n|0.38022056614863686|\n| 0.8637790886859875|\n|  0.579638250375865|\n|0.41885792670655064|\n| 0.7134159619163256|\n|0.01745816899347119|\n+-------------------+\nonly showing top 20 rows\n\ndf2: org.apache.spark.sql.DataFrame = [value2: double]\ndfid: org.apache.spark.sql.DataFrame = [value: double, id: bigint]\ndfid2: org.apache.spark.sql.DataFrame = [value2: double, id: bigint]\njoined: org.apache.spark.sql.DataFrame = [value: double, id: bigint ... 2 more fields]\nR: Double = 6.078867718715131E-4\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=142","http://172.17.0.2:4040/jobs/job?id=143"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257238_1970649651","id":"20191001-103352_1088882450","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:25+0000","dateFinished":"2019-10-22T16:31:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10578"},{"text":"%md \n### Pearson's chi-squared criteria:","user":"anonymous","dateUpdated":"2019-10-22T16:31:30+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Pearson&rsquo;s chi-squared criteria:</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257239_2094729917","id":"20191001-103423_951730408","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:30+0000","dateFinished":"2019-10-22T16:31:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10579"},{"text":"calcXi2(df, 20, (x: Double) => x, 2, 0.05)","user":"anonymous","dateUpdated":"2019-10-22T16:31:31+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(1.3655226211994886E-6,0.9999969529162627,0.04999977936968207)\n"},{"type":"TABLE","data":"int_id\tpi_\n12\t0.050002\n1\t0.04983\n13\t0.050008\n16\t0.049886\n6\t0.049984\n3\t0.049953\n5\t0.049979\n19\t0.050033\n15\t0.050111\n17\t0.050039\n9\t0.049682\n4\t0.049677\n8\t0.050116\n7\t0.049935\n10\t0.050051\n11\t0.050002\n14\t0.050238\n2\t0.050242\n0\t0.049819\n18\t0.050412\n"},{"type":"TEXT","data":"res59: (Double, Double, Boolean) = (12.065123884524938,27.587111638266812,true)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=144","http://172.17.0.2:4040/jobs/job?id=145","http://172.17.0.2:4040/jobs/job?id=146","http://172.17.0.2:4040/jobs/job?id=147","http://172.17.0.2:4040/jobs/job?id=148","http://172.17.0.2:4040/jobs/job?id=149","http://172.17.0.2:4040/jobs/job?id=150","http://172.17.0.2:4040/jobs/job?id=151"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257239_1109177351","id":"20191013-170406_131134035","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:31:31+0000","dateFinished":"2019-10-22T16:32:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10580"},{"text":"%md\n## Part 2.","user":"anonymous","dateUpdated":"2019-10-22T16:32:02+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Part 2.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257239_-1151524552","id":"20191013-170854_1297281925","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:32:02+0000","dateFinished":"2019-10-22T16:32:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10581"},{"text":"import scala.math.{tan, Pi}\n\ndef G(x: Double) = tan(Pi * (x - 0.5))","user":"anonymous","dateUpdated":"2019-10-22T16:32:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.math.{tan, Pi}\nG: (x: Double)Double\n"}]},"apps":[],"jobName":"paragraph_1571069257240_-852404527","id":"20191013-194307_1299559140","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:32:03+0000","dateFinished":"2019-10-22T16:32:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10582"},{"text":"val N = 100000","user":"anonymous","dateUpdated":"2019-10-22T16:32:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"N: Int = 100000\n"}]},"apps":[],"jobName":"paragraph_1571069257240_1902897384","id":"20191013-195917_1880456438","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:32:03+0000","dateFinished":"2019-10-22T16:32:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10583"},{"text":"val Gudf = udf(G(_:Double):Double)\nval cauchyDistribution = randomDf(N, random).select(Gudf('value).as(\"value\"))","user":"anonymous","dateUpdated":"2019-10-22T16:32:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Gudf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,DoubleType,Some(List(DoubleType)))\ncauchyDistribution: org.apache.spark.sql.DataFrame = [value: double]\n"}]},"apps":[],"jobName":"paragraph_1571069257240_-1732239081","id":"20191013-195518_42234506","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:32:03+0000","dateFinished":"2019-10-22T16:32:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10584"},{"text":"%md\n### Drawing a histogram","user":"anonymous","dateUpdated":"2019-10-22T16:32:03+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Drawing a histogram</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257241_-543941724","id":"20191013-202649_759003598","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:32:03+0000","dateFinished":"2019-10-22T16:32:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10585"},{"text":"val a = -5.0\nval b = 5.0\nval M = 100.0\nval interval = (b - a) / M\nval groupedDf = cauchyDistribution.filter('value > a && 'value < b).withColumn(\"int_id\", (('value - a) / interval).cast(IntegerType)).groupBy('int_id).agg((count(\"*\") / N.toDouble).as(\"pi_\"))\nz.show(groupedDf)","user":"anonymous","dateUpdated":"2019-10-22T17:14:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"int_id":"string","pi_":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"int_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"pi_","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571069257241_-2017004517","id":"20191014-101143_1896981785","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:32:04+0000","dateFinished":"2019-10-22T16:32:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10586","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=153","http://172.17.0.2:4040/jobs/job?id=154","http://172.17.0.2:4040/jobs/job?id=155","http://172.17.0.2:4040/jobs/job?id=156","http://172.17.0.2:4040/jobs/job?id=157"],"interpreterSettingId":"spark"}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"int_id\tpi_\n31\t0.00763\n85\t0.00242\n65\t0.00941\n53\t0.02949\n78\t0.00309\n34\t0.00919\n81\t0.00306\n28\t0.00592\n76\t0.0037\n26\t0.0047\n27\t0.00517\n44\t0.02374\n12\t0.00234\n91\t0.00186\n22\t0.00365\n93\t0.00161\n47\t0.02946\n1\t0.00126\n52\t0.0299\n13\t0.00208\n86\t0.00225\n6\t0.00145\n16\t0.00289\n3\t0.0014\n40\t0.01745\n20\t0.00323\n94\t0.00131\n57\t0.01981\n54\t0.02606\n96\t0.00127\n48\t0.03158\n5\t0.00143\n19\t0.00304\n92\t0.00163\n64\t0.01074\n41\t0.01893\n43\t0.02262\n15\t0.00262\n37\t0.01253\n61\t0.01418\n88\t0.00176\n17\t0.0026\n9\t0.00166\n72\t0.0053\n35\t0.01017\n59\t0.01701\n55\t0.0241\n4\t0.00145\n8\t0.0019\n39\t0.01482\n23\t0.00377\n49\t0.03155\n7\t0.00158\n84\t0.00271\n87\t0.00193\n51\t0.03053\n69\t0.00693\n97\t0.00135\n63\t0.01136\n77\t0.00334\n10\t0.00212\n50\t0.0314\n45\t0.02666\n38\t0.01367\n82\t0.00291\n80\t0.00301\n25\t0.00459\n73\t0.0049\n24\t0.00413\n70\t0.00572\n62\t0.01268\n95\t0.00125\n29\t0.00634\n21\t0.00353\n98\t0.00135\n90\t0.00179\n32\t0.00757\n60\t0.01509\n75\t0.00413\n56\t0.02215\n58\t0.01927\n33\t0.00812\n11\t0.00214\n83\t0.00252\n68\t0.00713\n71\t0.00546\n14\t0.00217\n42\t0.02\n79\t0.00373\n2\t0.00146\n30\t0.00653\n99\t0.00141\n66\t0.00834\n46\t0.02876\n67\t0.00802\n0\t0.00128\n18\t0.00292\n74\t0.00422\n36\t0.01102\n89\t0.00215\n"},{"type":"TEXT","data":"a: Double = -5.0\nb: Double = 5.0\nM: Double = 100.0\ninterval: Double = 0.1\ngroupedDf: org.apache.spark.sql.DataFrame = [int_id: int, pi_: double]\n"}]}},{"text":"%md \n### Calculating pointed Mode and Median","user":"anonymous","dateUpdated":"2019-10-22T16:32:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating pointed Mode and Median</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571243258787_1110111474","id":"20191016-162738_1714813113","dateCreated":"2019-10-16T16:27:38+0000","dateStarted":"2019-10-22T16:32:36+0000","dateFinished":"2019-10-22T16:32:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10587"},{"text":"val cauchyArr = cauchyDistribution.collect.map(_.getDouble(0))","user":"anonymous","dateUpdated":"2019-10-22T16:32:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cauchyArr: Array[Double] = Array(-0.8475641340142649, 1.1431136255918335, -1.982453804468933, -2.3748033589437663, 4.302898261197353, -5.588927851321203, -3.6018246949980504, -0.2030526131753238, -1.8995543312759304, 0.71558112869914, 0.8011301650744912, 1.6512534765775446, -0.30179919571962865, -0.4563554693537249, 4.014582567540025, -0.3106177103579543, -33.88638486611488, 0.31753878528961976, -0.09357191501913736, -1.9690239570951322, -1.7919578854485596, 1.560568995776354, 84.40291956696038, 3.8428207577374396, 5.180001638195758, -0.6373604775882056, -25.904398032315786, -0.18021285253800848, -0.7710212174249632, -0.8891623179066851, 3.2749666789351086, -0.5982904175423552, -7.60438104664526, 0.7751053388894362, 5.119116728733143, -5.695536206303508, 2.807464780432848, 0.19575130528..."}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=158"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571245443183_-88039126","id":"20191016-170403_735218905","dateCreated":"2019-10-16T17:04:03+0000","dateStarted":"2019-10-22T16:32:36+0000","dateFinished":"2019-10-22T16:32:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10588"},{"text":"val pointed_median = median(cauchyArr)\nval pointed_mode = mode(cauchyArr, 0.0001)","user":"anonymous","dateUpdated":"2019-10-22T16:32:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pointed_median: Double = -12.982834945531266\npointed_mode: Double = 0.43885\n"}]},"apps":[],"jobName":"paragraph_1571245851678_-491480209","id":"20191016-171051_1255840469","dateCreated":"2019-10-16T17:10:51+0000","dateStarted":"2019-10-22T16:32:37+0000","dateFinished":"2019-10-22T16:32:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10589"},{"text":"%md\n### Calculating interval Mode and Median","user":"anonymous","dateUpdated":"2019-10-22T16:32:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating interval Mode and Median</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571246374596_-1490618983","id":"20191016-171934_192158188","dateCreated":"2019-10-16T17:19:34+0000","dateStarted":"2019-10-22T16:32:38+0000","dateFinished":"2019-10-22T16:32:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10590"},{"text":"calcIntervalStatistic(cauchyArr, 10, median)","user":"anonymous","dateUpdated":"2019-10-22T16:32:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res61: (Double, Double) = (-35.80197281422701,9.836302923164475)\n"}]},"apps":[],"jobName":"paragraph_1571246406837_1723198707","id":"20191016-172006_1474086445","dateCreated":"2019-10-16T17:20:06+0000","dateStarted":"2019-10-22T16:32:38+0000","dateFinished":"2019-10-22T16:32:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10591"},{"text":"calcIntervalStatistic(cauchyArr, 10, (x: Array[Double]) => mode(x, 0.0001))","user":"anonymous","dateUpdated":"2019-10-22T16:32:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res62: (Double, Double) = (-0.15239534432846286,1.0300953443284628)\n"}]},"apps":[],"jobName":"paragraph_1571246497473_-1777394020","id":"20191016-172137_155503474","dateCreated":"2019-10-16T17:21:37+0000","dateStarted":"2019-10-22T16:32:40+0000","dateFinished":"2019-10-22T16:32:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10592"},{"text":"%md \n### Pearson's chi-squared criteria:","user":"anonymous","dateUpdated":"2019-10-22T16:32:41+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Pearson&rsquo;s chi-squared criteria:</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257241_-2020640247","id":"20191014-101538_2012387827","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:32:41+0000","dateFinished":"2019-10-22T16:32:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10593"},{"text":"def CauchyDF(x: Double) = scala.math.atan(x) / Pi + 0.5 // Cauchy distribution function\ncalcXi2(cauchyDistribution.filter('value > -10 && 'value < 10), 20, CauchyDF, 2, 0.05)","user":"anonymous","dateUpdated":"2019-10-22T16:32:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"(-9.999199449888271,9.999526962343921,0.9999363206116098)\n"},{"type":"TABLE","data":"int_id\tpi_\n12\t0.04655509393256507\n1\t0.004560455404727067\n13\t0.026401512319637728\n6\t0.02661511678824321\n16\t0.007679080646367122\n3\t0.008127650030438636\n5\t0.01588149224081768\n19\t0.0038021595411776013\n15\t0.011182193931497046\n9\t0.2678172827375549\n17\t0.00567119864147558\n4\t0.011118112590915401\n8\t0.1082120237955378\n7\t0.04809304610652455\n10\t0.2666210977133642\n11\t0.11094616099368798\n14\t0.01582809112366631\n2\t0.006408134058164497\n0\t0.0036205957428629408\n18\t0.004848821437344469\n"},{"type":"TEXT","data":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 335.0 failed 1 times, most recent failure: Lost task 1.0 in stage 335.0 (TID 6353, localhost, executor driver): ExecutorLostFailure (executor driver exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 2470660 ms\nDriver stacktrace:\n  at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1517)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1505)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1504)\n  at scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n  at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n  at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1504)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:814)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:814)\n  at scala.Option.foreach(Option.scala:257)\n  at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:814)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1732)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1687)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1676)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:630)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2029)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2050)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2069)\n  at org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:336)\n  at org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n  at org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:2861)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2150)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2150)\n  at org.apache.spark.sql.Dataset$$anonfun$55.apply(Dataset.scala:2842)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:65)\n  at org.apache.spark.sql.Dataset.withAction(Dataset.scala:2841)\n  at org.apache.spark.sql.Dataset.head(Dataset.scala:2150)\n  at org.apache.spark.sql.Dataset.head(Dataset.scala:2157)\n  at org.apache.spark.sql.Dataset.first(Dataset.scala:2164)\n  at calcXi2(<console>:119)\n  ... 59 elided\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=159","http://172.17.0.2:4040/jobs/job?id=160","http://172.17.0.2:4040/jobs/job?id=161","http://172.17.0.2:4040/jobs/job?id=162","http://172.17.0.2:4040/jobs/job?id=163","http://172.17.0.2:4040/jobs/job?id=164","http://172.17.0.2:4040/jobs/job?id=165","http://172.17.0.2:4040/jobs/job?id=166"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571242682096_1545563119","id":"20191016-161802_1932990354","dateCreated":"2019-10-16T16:18:02+0000","dateStarted":"2019-10-22T16:32:41+0000","dateFinished":"2019-10-22T17:14:33+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:10594"},{"text":"%md\n## Part 3","user":"anonymous","dateUpdated":"2019-10-22T16:21:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Part 3</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257242_17739517","id":"20191014-120238_1283133298","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:21:59+0000","dateFinished":"2019-10-22T16:21:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10595"},{"text":"%md\n### Lets take a normal distribution from -n to n and generate probability and distribution function values","user":"anonymous","dateUpdated":"2019-10-22T16:21:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Lets take a normal distribution from -n to n and generate probability and distribution function values</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257242_1037135034","id":"20191014-125527_2061783891","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:21:59+0000","dateFinished":"2019-10-22T16:21:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10596"},{"text":"val n = 10000\nval k = 2000.0\n\ndef nd(x: Double) = {\n    ((1 / scala.math.pow(2 * Pi, 0.5)) * scala.math.exp(-scala.math.pow(x, 2)/2))\n}\nval p = (-n to n).map(i => nd(i / k)).toList\nvar s = 0.0\nval dfv = p.map(pi => {s += (pi / k); s})","user":"anonymous","dateUpdated":"2019-10-22T16:21:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"n: Int = 10000\nk: Double = 2000.0\nnd: (x: Double)Double\np: List[Double] = List(1.4867195147342977E-6, 1.4904407770885918E-6, 1.4941709802283082E-6, 1.497910144662559E-6, 1.5016582909450847E-6, 1.5054154396743018E-6, 1.5091816114933973E-6, 1.5129568270904406E-6, 1.516741107198463E-6, 1.520534472595553E-6, 1.5243369441049261E-6, 1.5281485425950577E-6, 1.531969288979748E-6, 1.535799204218209E-6, 1.5396383093151816E-6, 1.5434866253210153E-6, 1.5473441733317411E-6, 1.5512109744892054E-6, 1.555087049981138E-6, 1.558972421041237E-6, 1.5628671089492902E-6, 1.5667711350312527E-6, 1.570684520659323E-6, 1.574607287252075E-6, 1.5785394562745316E-6, 1.5824810492382626E-6, 1.5864320877014617E-6, 1.5903925932690718E-6, 1.5943625875928708E-6, 1.5983420923715423E-6, 1.6023311293508047E-6, 1.606329720323..."}]},"apps":[],"jobName":"paragraph_1571069257243_1233292187","id":"20191014-122149_1228412350","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:21:59+0000","dateFinished":"2019-10-22T16:22:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10597"},{"text":"p.sum / k","user":"anonymous","dateUpdated":"2019-10-22T16:22:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res45: Double = 0.9999994274399062\n"}]},"apps":[],"jobName":"paragraph_1571069257243_1014218941","id":"20191014-122211_727421972","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:00+0000","dateFinished":"2019-10-22T16:22:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10598"},{"text":"%md\n### Probability function","user":"anonymous","dateUpdated":"2019-10-22T16:22:00+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Probability function</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257243_-303011788","id":"20191014-125745_87329235","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:00+0000","dateFinished":"2019-10-22T16:22:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10599"},{"text":"println(\"%table\\nx\\ty\")\n(0 until p.length).foreach(i => println(i + \"\\t\" + p(i)))","user":"anonymous","dateUpdated":"2019-10-22T16:30:52+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"x":"string","y":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"x","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"y","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"x\ty\n"}]},"apps":[],"jobName":"paragraph_1571069257243_-1395161328","id":"20191014-122221_1100115833","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:00+0000","dateFinished":"2019-10-22T16:22:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10600"},{"text":"%md\n### Distribution function","user":"anonymous","dateUpdated":"2019-10-22T16:22:01+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Distribution function</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257244_-1536562989","id":"20191014-125910_2119465031","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:01+0000","dateFinished":"2019-10-22T16:22:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10601"},{"text":"println(\"%table\\nx\\ty\")\n(0 until p.length).foreach(i => println(i + \"\\t\" + p.take(i + 1).sum / k))","user":"anonymous","dateUpdated":"2019-10-22T16:31:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"x":"string","y":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"x","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"y","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"x\ty\n"}]},"apps":[],"jobName":"paragraph_1571069257244_-1409006420","id":"20191014-122231_1838399354","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:01+0000","dateFinished":"2019-10-22T16:22:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10602"},{"text":"dfv.size","user":"anonymous","dateUpdated":"2019-10-22T16:22:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res48: Int = 20001\n"}]},"apps":[],"jobName":"paragraph_1571069257245_-316110962","id":"20191014-122243_1877199398","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:01+0000","dateFinished":"2019-10-22T16:22:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10603"},{"text":"%md\n### Generating a sample for N values from a to b","user":"anonymous","dateUpdated":"2019-10-22T16:22:01+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Generating a sample for N values from a to b</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257245_1888878362","id":"20191014-125057_817812560","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:02+0000","dateFinished":"2019-10-22T16:22:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10604"},{"text":"val N = 1000\nval (a, b) = (0.0, 200.0)","user":"anonymous","dateUpdated":"2019-10-22T16:22:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"N: Int = 1000\na: Double = 0.0\nb: Double = 200.0\n"}]},"apps":[],"jobName":"paragraph_1571069257245_-1022956474","id":"20191014-125116_792364804","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:02+0000","dateFinished":"2019-10-22T16:22:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10605"},{"text":"dfv.count(_ <= 0.5)","user":"anonymous","dateUpdated":"2019-10-22T16:22:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res49: Int = 10000\n"}]},"apps":[],"jobName":"paragraph_1571233945707_521021739","id":"20191016-135225_65098156","dateCreated":"2019-10-16T13:52:25+0000","dateStarted":"2019-10-22T16:22:02+0000","dateFinished":"2019-10-22T16:22:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10606"},{"text":"val res: List[Double] = (0 until N).map(i => dfv.count(_ <= random.next).toDouble * (b - a) / (2 * n) + a).toList","user":"anonymous","dateUpdated":"2019-10-22T16:22:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res: List[Double] = List(99.18, 100.16, 100.11, 99.56, 100.15, 100.32, 100.58, 99.94, 100.1, 99.69, 100.06, 100.24, 99.72, 99.73, 99.69, 99.98, 100.47, 100.02, 99.91, 99.81, 99.99, 99.92, 100.5, 99.69, 99.87, 100.13, 100.04, 100.51, 100.1, 100.81, 99.94, 100.01, 100.09, 100.09, 99.59, 100.58, 99.57, 100.55, 99.95, 100.11, 99.4, 99.83, 99.7, 100.1, 99.7, 100.33, 100.15, 100.01, 100.01, 100.27, 100.36, 100.6, 100.02, 100.45, 100.18, 99.57, 100.41, 99.7, 100.42, 100.34, 100.27, 100.37, 100.1, 100.59, 100.38, 100.18, 100.27, 99.98, 100.05, 100.18, 99.77, 100.06, 100.3, 99.49, 100.41, 100.01, 99.74, 99.92, 100.21, 100.19, 100.26, 99.84, 99.93, 99.77, 99.91, 100.28, 100.26, 99.69, 100.1, 99.46, 99.95, 99.61, 99.62, 100.25, 99.65, 100.29, 100.33, 100.04, 100.17, 100.0, 100.2, 99.65, 100.24, 10..."}]},"apps":[],"jobName":"paragraph_1571069257246_841572519","id":"20191014-122305_1506052187","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:03+0000","dateFinished":"2019-10-22T16:22:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10607"},{"text":"%md\n### Drawing a histogram","user":"anonymous","dateUpdated":"2019-10-22T16:22:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Drawing a histogram</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257246_-1940363557","id":"20191014-130027_294373302","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:10+0000","dateFinished":"2019-10-22T16:22:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10608"},{"text":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\n\nval df = spark.createDataFrame(\n    spark.sparkContext.parallelize(res).map(t => Row(t)), \n    StructType(\n        Seq(\n            StructField(\"value\", DataTypes.DoubleType, false)\n            )\n    )\n)\n\nz.show(df.withColumn(\"value\", 'value).groupBy('value).count)","user":"anonymous","dateUpdated":"2019-10-22T16:22:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"value":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"value","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"value\tcount\n100.49\t7\n99.84\t12\n100.51\t4\n100.03\t14\n100.34\t9\n99.47\t1\n100.36\t6\n99.69\t9\n99.27\t3\n100.73\t1\n100.25\t7\n99.18\t1\n100.12\t12\n100.87\t1\n99.63\t8\n100.06\t11\n100.45\t2\n100.19\t9\n99.97\t6\n100.1\t17\n99.39\t2\n100.57\t1\n99.6\t6\n99.91\t13\n100.6\t2\n99.51\t3\n100.37\t8\n99.8\t6\n98.87\t1\n99.31\t2\n100.63\t3\n100.27\t15\n99.49\t4\n100.17\t10\n99.26\t2\n98.97\t1\n100.48\t5\n100.88\t1\n100.62\t2\n100.26\t15\n100.93\t2\n100.35\t3\n99.4\t5\n99.76\t5\n100.69\t1\n99.98\t14\n99.12\t1\n99.52\t2\n99.65\t9\n100.44\t2\n100.11\t13\n100.42\t2\n100.05\t14\n99.07\t1\n99.02\t1\n99.62\t11\n100.01\t21\n99.67\t4\n100.13\t9\n99.89\t4\n99.96\t7\n100.71\t3\n99.53\t4\n100.53\t5\n99.73\t5\n100.14\t7\n100.76\t1\n100.61\t2\n100.23\t12\n100.52\t1\n100.59\t3\n100.09\t20\n100.21\t6\n100.39\t8\n99.37\t1\n100.33\t10\n99.64\t7\n100.8\t1\n99.25\t1\n100.54\t2\n100.66\t2\n99.88\t9\n99.54\t4\n100.58\t5\n98.86\t1\n99.7\t11\n100.94\t1\n100.65\t2\n100.04\t9\n100.32\t7\n99.72\t13\n100.68\t2\n99.66\t5\n100.5\t2\n100.46\t5\n100.38\t8\n100.7\t1\n100.41\t6\n99.77\t12\n99.74\t9\n100.9\t4\n99.41\t1\n100.22\t10\n100.47\t3\n99.36\t1\n99.85\t7\n99.92\t13\n99.44\t2\n99.43\t3\n99.99\t8\n100.18\t13\n99.94\t15\n99.9\t12\n99.83\t8\n100.2\t12\n99.81\t12\n99.42\t3\n100.67\t3\n99.75\t12\n99.48\t5\n100.43\t3\n99.87\t10\n100.75\t2\n100.29\t8\n99.5\t5\n99.79\t7\n99.71\t16\n99.95\t9\n100.55\t5\n99.78\t7\n99.55\t4\n100.07\t6\n100.08\t6\n100.02\t8\n99.82\t8\n100.91\t1\n99.34\t2\n99.59\t5\n100.24\t9\n100.0\t13\n99.33\t2\n99.38\t3\n100.28\t11\n99.86\t10\n99.68\t5\n99.58\t5\n99.57\t5\n100.15\t12\n99.46\t4\n100.3\t9\n100.4\t7\n100.16\t9\n100.31\t9\n99.15\t1\n99.61\t8\n99.2\t1\n99.93\t15\n100.81\t2\n100.56\t3\n99.45\t3\n100.83\t1\n99.56\t6\n99.19\t2\n"},{"type":"TEXT","data":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\ndf: org.apache.spark.sql.DataFrame = [value: double]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=115","http://172.17.0.2:4040/jobs/job?id=116","http://172.17.0.2:4040/jobs/job?id=117","http://172.17.0.2:4040/jobs/job?id=118","http://172.17.0.2:4040/jobs/job?id=119"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257246_477274542","id":"20191014-122315_2064418733","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:10+0000","dateFinished":"2019-10-22T16:22:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10609"},{"text":"%md\n### Calculating pointed Mean and Deviation","user":"anonymous","dateUpdated":"2019-10-22T16:22:12+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating pointed Mean and Deviation</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257246_-1308977150","id":"20191014-130125_1633773100","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:12+0000","dateFinished":"2019-10-22T16:22:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10610"},{"text":"val EV = df.select(avg('value)).first.getDouble(0)\nval EV2 = scala.math.pow(EV, 2)\n\nval D2 = df.select(avg(pow('value, 2) - EV2)).first.getDouble(0)\nscala.math.pow(D2, 0.5)","user":"anonymous","dateUpdated":"2019-10-22T16:22:12+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"EV: Double = 100.00864999999979\nEV2: Double = 10001.730074822459\nD2: Double = 0.11395927754118565\nres51: Double = 0.3375785501793407\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=120","http://172.17.0.2:4040/jobs/job?id=121"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257247_1323353160","id":"20191014-122325_1306908467","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:12+0000","dateFinished":"2019-10-22T16:22:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10611"},{"text":"%md\n### Calculating interval Mean and Variance intervals","user":"anonymous","dateUpdated":"2019-10-22T16:22:13+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating interval Mean and Variance intervals</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257247_374040768","id":"20191014-130213_1692483387","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:13+0000","dateFinished":"2019-10-22T16:22:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10612"},{"text":"val intervalMean = calcIntervalStatistic(res.toArray, 10, mean)","user":"anonymous","dateUpdated":"2019-10-22T16:22:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"intervalMean: (Double, Double) = (99.9980320529289,100.01926794707067)\n"}]},"apps":[],"jobName":"paragraph_1571069257248_1672456177","id":"20191014-122351_1090714781","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:13+0000","dateFinished":"2019-10-22T16:22:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10613"},{"text":"val intervalVariance = calcIntervalStatistic(res.toArray, 10, variance)","user":"anonymous","dateUpdated":"2019-10-22T16:22:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"intervalVariance: (Double, Double) = (0.10854181564121919,0.11937673935878144)\n"}]},"apps":[],"jobName":"paragraph_1571247183308_1759322840","id":"20191016-173303_1138335405","dateCreated":"2019-10-16T17:33:03+0000","dateStarted":"2019-10-22T16:22:13+0000","dateFinished":"2019-10-22T16:22:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10614"},{"text":"%md \n### Pearson's chi-squared criteria:","user":"anonymous","dateUpdated":"2019-10-22T16:22:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Pearson&rsquo;s chi-squared criteria:</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257248_1540145116","id":"20191014-130250_724854181","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:14+0000","dateFinished":"2019-10-22T16:22:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10615"},{"text":"import breeze.stats.distributions.Gaussian\n\ndef GaussianDF(x: Double) = Gaussian(100, 0.10392792062275404).probability(Double.MinValue, x) // Gaussian distribution function\n\ncalcXi2(df, 20, GaussianDF, 2, 0.05)","user":"anonymous","dateUpdated":"2019-10-22T16:22:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"1":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"int_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"pi_","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(98.86,100.94,0.10399999999999991)\n"},{"type":"TABLE","data":"int_id\tpi_\n12\t0.112\n1\t0.002\n13\t0.105\n6\t0.042\n16\t0.03\n3\t0.01\n5\t0.029\n19\t0.009\n15\t0.036\n9\t0.086\n17\t0.018\n4\t0.011\n8\t0.097\n7\t0.077\n10\t0.125\n11\t0.126\n14\t0.072\n2\t0.003\n0\t0.002\n18\t0.007\n"},{"type":"TEXT","data":"import breeze.stats.distributions.Gaussian\nGaussianDF: (x: Double)Double\nres52: (Double, Double, Boolean) = (1.9331872806888428E14,27.587111638266812,false)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=122","http://172.17.0.2:4040/jobs/job?id=123","http://172.17.0.2:4040/jobs/job?id=124","http://172.17.0.2:4040/jobs/job?id=125","http://172.17.0.2:4040/jobs/job?id=126","http://172.17.0.2:4040/jobs/job?id=127","http://172.17.0.2:4040/jobs/job?id=128","http://172.17.0.2:4040/jobs/job?id=129"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257249_-1073805521","id":"20191014-131409_1631994440","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-22T16:22:14+0000","dateFinished":"2019-10-22T16:22:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10616"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571744104131_-262762197","id":"20191022-113504_1368478164","dateCreated":"2019-10-22T11:35:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:21536","text":"val pi = GaussianDF(93) - GaussianDF(91)\nval N = df.count.toDouble\nprint(pi, N)\nscala.math.pow(2408 - pi * N, 2) / (pi * N)","dateUpdated":"2019-10-22T16:22:51+0000","dateFinished":"2019-10-22T16:22:51+0000","dateStarted":"2019-10-22T16:22:51+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(0.0,1000.0)pi: Double = 0.0\nN: Double = 1000.0\nres53: Double = Infinity\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=131"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571747895201_-1366643048","id":"20191022-123815_424052642","dateCreated":"2019-10-22T12:38:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22419","text":"GaussianDF(222.2) - GaussianDF(116)","dateUpdated":"2019-10-22T16:22:51+0000","dateFinished":"2019-10-22T16:22:52+0000","dateStarted":"2019-10-22T16:22:51+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res54: Double = 0.0\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571748402704_-982517597","id":"20191022-124642_1486415675","dateCreated":"2019-10-22T12:46:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22663","dateUpdated":"2019-10-22T13:06:14+0000"}],"name":"MMOD: Lab1","id":"2ERWXTN37","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}