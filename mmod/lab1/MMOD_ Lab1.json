{"paragraphs":[{"text":"%md\n## MMOD: Lab1 Базовая случайная величина. Генерация непрерывных и дискретных случайных величин.","user":"anonymous","dateUpdated":"2019-10-16T17:36:21+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>MMOD: Lab1 Базовая случайная величина. Генерация непрерывных и дискретных случайных величин.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257233_-560518086","id":"20191012-160955_881587067","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:21+0000","dateFinished":"2019-10-16T17:36:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:58521"},{"text":"%md\n### Preparing util functions","user":"anonymous","dateUpdated":"2019-10-16T17:36:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Preparing util functions</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257234_1924535919","id":"20191012-161356_135676605","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:22+0000","dateFinished":"2019-10-16T17:36:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58522"},{"text":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\n\nclass LinearCongruentGenerator(m: BigInt = BigInt(\"34359738368\"),\n                               k: BigInt = BigInt(\"152587890625\"),\n                               A0: BigInt = 9999) extends Serializable {\n\n  var prevValue: BigInt = A0\n\n  def next: Double = {\n    val result: BigInt = (k * prevValue) % m\n    prevValue = result\n    result.toDouble / m.toDouble\n  }\n}\n\nval random = new LinearCongruentGenerator\n\ndef randomDf(range: Int, random: LinearCongruentGenerator, columnName: String = \"value\") = {\n    spark.createDataFrame(\n        spark.sparkContext.parallelize((0 until range).map(i => random.next)).map(t => Row(t)), \n        StructType(\n            Seq(\n                StructField(columnName, DataTypes.DoubleType, false)\n            )\n        )\n    )\n}\n\ndef average(arr: Array[Double]): Double = arr.sum / arr.length\n\ndef mean(arr: Array[Double]): Double = average(arr)\n\ndef variance(arr: Array[Double]): Double = {\n    val sEV = average(arr)\n    average(arr.map(i => scala.math.pow(i - sEV, 2)))\n}\n\ndef median(arr: Array[Double]): Double = {\n    val sorted = arr.sortWith(_ < _)\n    if (sorted.length % 2 == 0) (arr(sorted.length / 2) + arr(sorted.length / 2 - 1)) / 2\n    else arr(sorted.length / 2)\n}\n\ndef mode(arr: Array[Double], interval: Double): Double = {\n    val intervalNumber = arr.groupBy(value => (value / interval).toInt).mapValues(_.size).maxBy(_._2)._1\n    (intervalNumber * interval + (intervalNumber + 1) * interval) / 2\n}","user":"anonymous","dateUpdated":"2019-10-16T17:36:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\ndefined class LinearCongruentGenerator\nrandom: LinearCongruentGenerator = LinearCongruentGenerator@36ed23fb\nrandomDf: (range: Int, random: LinearCongruentGenerator, columnName: String)org.apache.spark.sql.DataFrame\naverage: (arr: Array[Double])Double\nmean: (arr: Array[Double])Double\nvariance: (arr: Array[Double])Double\nmedian: (arr: Array[Double])Double\nmode: (arr: Array[Double], interval: Double)Double\n"}]},"apps":[],"jobName":"paragraph_1571069257234_-364478169","id":"20191001-084552_364857475","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:22+0000","dateFinished":"2019-10-16T17:36:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58523"},{"text":"%md\n### Lets calculate interval statistics with Bootstrap method","user":"anonymous","dateUpdated":"2019-10-16T17:36:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Lets calculate interval statistics with Bootstrap method</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571233225613_1807967391","id":"20191016-134025_630493356","dateCreated":"2019-10-16T13:40:25+0000","dateStarted":"2019-10-16T17:36:45+0000","dateFinished":"2019-10-16T17:36:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58524"},{"text":"import scala.collection.mutable.ArrayBuffer\n\n\ndef generateSample(arr: Array[Double], n: Int): Array[Double] = {\n    val buf = new ArrayBuffer[Double]()\n    (0 until n).foreach(i => buf += arr((n * random.next).toInt))\n    buf.toArray\n}\n\ndef calcIntervalStatistic(arr: Array[Double], m: Int, statistic: Array[Double] => Double): (Double, Double) = {\n    val point_stat = statistic(arr)\n    \n    val samples = (0 to m).map(i => generateSample(arr, arr.length))\n    val statistics = samples.map(statistic).toArray\n    val S2 = variance(statistics)\n    val s = scala.math.pow(S2, 0.5)\n    (point_stat - s, point_stat + s)\n}","user":"anonymous","dateUpdated":"2019-10-16T17:36:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.collection.mutable.ArrayBuffer\ngenerateSample: (arr: Array[Double], n: Int)Array[Double]\ncalcIntervalStatistic: (arr: Array[Double], m: Int, statistic: Array[Double] => Double)(Double, Double)\n"}]},"apps":[],"jobName":"paragraph_1571233260023_-1806432002","id":"20191016-134100_492875556","dateCreated":"2019-10-16T13:41:00+0000","dateStarted":"2019-10-16T17:36:45+0000","dateFinished":"2019-10-16T17:36:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58525"},{"text":"%md \n### Pearson's chi-squared criteria:","user":"anonymous","dateUpdated":"2019-10-16T17:36:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Pearson&rsquo;s chi-squared criteria:</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571240900949_-1945973797","id":"20191016-154820_656001612","dateCreated":"2019-10-16T15:48:20+0000","dateStarted":"2019-10-16T17:36:46+0000","dateFinished":"2019-10-16T17:36:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58526"},{"text":"def calcXi2(df: org.apache.spark.sql.DataFrame, a: Double, b: Double, M: Double, F: Double => Double) = {\n    val N = df.count.toDouble\n    val interval = (b - a) / M\n    val groupedDf = df.filter('value > a && 'value < b).withColumn(\"int_id\", (('value - a) / interval).cast(IntegerType)).groupBy('int_id).agg((count(\"*\") / N).as(\"pi_\"))\n    \n    def p(i: Int) = F(a + interval * (i + 1)) - F(a + interval * i)\n    val pi = udf(p(_:Int):Double) // Creating udf that will calculate difference of distribution function on ends of i'th interval\n    \n    N * groupedDf.agg(sum(pow('pi_ - pi('int_id), 2) / pi('int_id))).first.getDouble(0)\n}","user":"anonymous","dateUpdated":"2019-10-16T17:36:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"calcXi2: (df: org.apache.spark.sql.DataFrame, a: Double, b: Double, M: Double, F: Double => Double)Double\n"}]},"apps":[],"jobName":"paragraph_1571240954131_1587090153","id":"20191016-154914_1954526450","dateCreated":"2019-10-16T15:49:14+0000","dateStarted":"2019-10-16T17:36:46+0000","dateFinished":"2019-10-16T17:36:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58527"},{"text":"%md\n## Part 1.","user":"anonymous","dateUpdated":"2019-10-16T17:36:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Part 1.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1571233294171_1523378599","id":"20191016-134134_1083037282","dateCreated":"2019-10-16T13:41:34+0000","dateStarted":"2019-10-16T17:36:47+0000","dateFinished":"2019-10-16T17:36:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58528"},{"text":"%md\n### Constants","user":"anonymous","dateUpdated":"2019-10-16T17:36:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Constants</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257235_140599765","id":"20191012-161504_1431968683","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:47+0000","dateFinished":"2019-10-16T17:36:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58529"},{"text":"val N = 1000000 // Sample size\nval M = 20 // Bins count","user":"anonymous","dateUpdated":"2019-10-16T17:36:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"N: Int = 1000000\nM: Int = 20\n"}]},"apps":[],"jobName":"paragraph_1571069257235_-1058768338","id":"20191012-161716_1721258311","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:47+0000","dateFinished":"2019-10-16T17:36:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58530"},{"text":"%md\n### Creating a sample","user":"anonymous","dateUpdated":"2019-10-16T17:36:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Creating a sample</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257235_-628873443","id":"20191012-161737_1519390953","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:48+0000","dateFinished":"2019-10-16T17:36:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58531"},{"text":"val df = randomDf(N, random)\ndf.show(10)","user":"anonymous","dateUpdated":"2019-10-16T17:36:48+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|               value|\n+--------------------+\n|  0.4800929077609908|\n|  0.2722753253474366|\n|9.448216005694121E-4|\n|0.047822893102420494|\n| 0.08320525518502109|\n|  0.5972118419304024|\n|  0.4310368061705958|\n| 0.30819851948763244|\n|  0.3657895722135436|\n|  0.6857267734303605|\n+--------------------+\nonly showing top 10 rows\n\ndf: org.apache.spark.sql.DataFrame = [value: double]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257235_-1442612764","id":"20191012-144505_885667887","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:48+0000","dateFinished":"2019-10-16T17:36:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58532"},{"text":"%md\n### Drawing histogram with M bins","user":"anonymous","dateUpdated":"2019-10-16T17:36:52+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Drawing histogram with M bins</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257236_-1965284583","id":"20191012-161826_232387597","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:52+0000","dateFinished":"2019-10-16T17:36:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58533"},{"text":"import org.apache.spark.sql.types.IntegerType\nz.show(df.withColumn(\"int_id\", ('value * M).cast(IntegerType)).groupBy(\"int_id\").agg((count(\"*\") / N).as(\"p\")))","user":"anonymous","dateUpdated":"2019-10-16T17:38:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"int_id":"string","p":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"int_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"p","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"int_id\tp\n12\t0.049872\n1\t0.049743\n13\t0.049973\n6\t0.050167\n16\t0.049798\n3\t0.050026\n5\t0.050099\n19\t0.050132\n15\t0.049846\n9\t0.049875\n17\t0.049693\n4\t0.050155\n8\t0.050002\n7\t0.050174\n10\t0.050317\n11\t0.050689\n14\t0.049708\n2\t0.049732\n0\t0.050064\n18\t0.049935\n"},{"type":"TEXT","data":"import org.apache.spark.sql.types.IntegerType\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1","http://172.17.0.2:4040/jobs/job?id=2","http://172.17.0.2:4040/jobs/job?id=3","http://172.17.0.2:4040/jobs/job?id=4","http://172.17.0.2:4040/jobs/job?id=5"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257236_-389029586","id":"20191001-085208_579427695","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:52+0000","dateFinished":"2019-10-16T17:36:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58534"},{"text":"%md\n### Calculating pointed Mean and Variance","user":"anonymous","dateUpdated":"2019-10-16T17:36:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating pointed Mean and Variance</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257236_492361184","id":"20191012-163117_1936812781","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:57+0000","dateFinished":"2019-10-16T17:36:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58535"},{"text":"val EV = df.agg(avg('value)).first.getDouble(0)\nval EV2 = scala.math.pow(EV, 2)\nval D = df.agg(avg(pow('value, 2) - EV2)).first.getDouble(0)","user":"anonymous","dateUpdated":"2019-10-16T17:36:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"EV: Double = 0.4998471249879259\nEV2: Double = 0.2498471483586952\nD: Double = 0.08323418505663106\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=6","http://172.17.0.2:4040/jobs/job?id=7"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257237_-1582872723","id":"20191001-093930_847132398","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:57+0000","dateFinished":"2019-10-16T17:36:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58536"},{"text":"%md\n### Calculating interval Mean and Variance","user":"anonymous","dateUpdated":"2019-10-16T17:36:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating interval Mean and Variance</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257237_1786248277","id":"20191013-172239_763410667","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:36:59+0000","dateFinished":"2019-10-16T17:36:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58537"},{"text":"calcIntervalStatistic(df.collect.map(_.getDouble(0)), 10, mean)","user":"anonymous","dateUpdated":"2019-10-16T17:36:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res3: (Double, Double) = (0.4996899500483112,0.5000042999275406)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571232877947_-1963489669","id":"20191016-133437_1431946506","dateCreated":"2019-10-16T13:34:37+0000","dateStarted":"2019-10-16T17:36:59+0000","dateFinished":"2019-10-16T17:37:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58538"},{"text":"calcIntervalStatistic(df.collect.map(_.getDouble(0)), 10, variance)","user":"anonymous","dateUpdated":"2019-10-16T17:37:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res4: (Double, Double) = (0.0831748621145287,0.0832935080264086)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=9"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571233599483_1462857979","id":"20191016-134639_166229228","dateCreated":"2019-10-16T13:46:39+0000","dateStarted":"2019-10-16T17:37:07+0000","dateFinished":"2019-10-16T17:37:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58539"},{"text":"%md \n### Calculating correlation","user":"anonymous","dateUpdated":"2019-10-16T17:37:15+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating correlation</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257238_1886595107","id":"20191013-170034_865274919","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:37:15+0000","dateFinished":"2019-10-16T17:37:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58540"},{"text":"val df2 = randomDf(N, random, \"value2\") // Generating a second one sample\ndf2.show\n\nval dfid = df.withColumn(\"id\", monotonically_increasing_id)\nval dfid2 = df2.withColumn(\"id\", monotonically_increasing_id)\n\nval joined = dfid.join(dfid2, dfid.col(\"id\") === dfid2.col(\"id\"))\nval R = joined.agg((avg('value * 'value2) * 12) - 3).first.getDouble(0)","user":"anonymous","dateUpdated":"2019-10-16T17:37:15+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+\n|             value2|\n+-------------------+\n|   0.92820527634467|\n|0.42840313582564704|\n| 0.7708497927233111|\n|0.36851674361969344|\n| 0.9229497038468253|\n| 0.9555186074867379|\n| 0.3386676073714625|\n| 0.8271650750830304|\n| 0.5893536009534728|\n| 0.7383999940648209|\n| 0.8635452822491061|\n| 0.5613547120883595|\n| 0.9669677489146125|\n|0.28534807680989616|\n|0.32253359860624187|\n|0.01688643588568084|\n| 0.9703429289802443|\n| 0.9796636369719636|\n| 0.5676833376928698|\n| 0.5145610277249943|\n+-------------------+\nonly showing top 20 rows\n\ndf2: org.apache.spark.sql.DataFrame = [value2: double]\ndfid: org.apache.spark.sql.DataFrame = [value: double, id: bigint]\ndfid2: org.apache.spark.sql.DataFrame = [value2: double, id: bigint]\njoined: org.apache.spark.sql.DataFrame = [value: double, id: bigint ... 2 more fields]\nR: Double = -0.005318577859776408\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=10","http://172.17.0.2:4040/jobs/job?id=11"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257238_1970649651","id":"20191001-103352_1088882450","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:37:15+0000","dateFinished":"2019-10-16T17:37:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58541"},{"text":"%md \n### Pearson's chi-squared criteria:","user":"anonymous","dateUpdated":"2019-10-16T17:37:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Pearson&rsquo;s chi-squared criteria:</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257239_2094729917","id":"20191001-103423_951730408","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:37:22+0000","dateFinished":"2019-10-16T17:37:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58542"},{"text":"calcXi2(df, 0, 1, 20, (x: Double) => x)\n// xi2(a, k = 20 - 1) > 34.8","user":"anonymous","dateUpdated":"2019-10-16T17:37:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res5: Double = 22.165399999997522\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=12","http://172.17.0.2:4040/jobs/job?id=13"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257239_1109177351","id":"20191013-170406_131134035","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:37:22+0000","dateFinished":"2019-10-16T17:37:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58543"},{"text":"%md\n## Part 2.","user":"anonymous","dateUpdated":"2019-10-16T17:37:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Part 2.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257239_-1151524552","id":"20191013-170854_1297281925","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:37:25+0000","dateFinished":"2019-10-16T17:37:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58544"},{"text":"import scala.math.{tan, Pi}\n\ndef G(x: Double) = tan(Pi * (x - 0.5))","user":"anonymous","dateUpdated":"2019-10-16T17:37:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.math.{tan, Pi}\nG: (x: Double)Double\n"}]},"apps":[],"jobName":"paragraph_1571069257240_-852404527","id":"20191013-194307_1299559140","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:37:25+0000","dateFinished":"2019-10-16T17:37:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58545"},{"text":"val N = 1000000","user":"anonymous","dateUpdated":"2019-10-16T17:37:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"N: Int = 1000000\n"}]},"apps":[],"jobName":"paragraph_1571069257240_1902897384","id":"20191013-195917_1880456438","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:37:26+0000","dateFinished":"2019-10-16T17:37:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58546"},{"text":"val Gudf = udf(G(_:Double):Double)\nval cauchyDistribution = randomDf(N, random).select(Gudf('value).as(\"value\"))","user":"anonymous","dateUpdated":"2019-10-16T17:37:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Gudf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,DoubleType,Some(List(DoubleType)))\ncauchyDistribution: org.apache.spark.sql.DataFrame = [value: double]\n"}]},"apps":[],"jobName":"paragraph_1571069257240_-1732239081","id":"20191013-195518_42234506","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:37:26+0000","dateFinished":"2019-10-16T17:37:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58547"},{"text":"%md\n### Drawing a histogram","user":"anonymous","dateUpdated":"2019-10-16T17:37:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Drawing a histogram</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257241_-543941724","id":"20191013-202649_759003598","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:37:27+0000","dateFinished":"2019-10-16T17:37:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58548"},{"text":"val a = -5.0\nval b = 5.0\nval M = 100.0\nval interval = (b - a) / M\nval groupedDf = cauchyDistribution.filter('value > a && 'value < b).withColumn(\"int_id\", (('value - a) / interval).cast(IntegerType)).groupBy('int_id).agg((count(\"*\") / N.toDouble).as(\"pi_\"))\nz.show(groupedDf)","user":"anonymous","dateUpdated":"2019-10-16T17:38:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"int_id":"string","pi_":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"int_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"pi_","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"int_id\tpi_\n31\t0.007157\n85\t0.002327\n65\t0.009539\n53\t0.028343\n78\t0.003612\n34\t0.009309\n81\t0.002957\n28\t0.005598\n76\t0.003954\n27\t0.00519\n26\t0.004816\n44\t0.024574\n12\t0.002082\n91\t0.001766\n22\t0.003745\n93\t0.001664\n47\t0.030106\n1\t0.001291\n52\t0.029717\n13\t0.002199\n16\t0.002563\n86\t0.002248\n6\t0.001628\n3\t0.001417\n40\t0.016965\n20\t0.003244\n94\t0.001502\n57\t0.020435\n54\t0.026249\n96\t0.001404\n48\t0.031169\n5\t0.001565\n19\t0.00315\n92\t0.001698\n64\t0.010245\n41\t0.018371\n43\t0.022258\n15\t0.002508\n37\t0.012457\n61\t0.013675\n88\t0.002026\n9\t0.001818\n17\t0.002686\n72\t0.00526\n35\t0.010352\n55\t0.024517\n59\t0.016825\n4\t0.001453\n8\t0.001754\n39\t0.015078\n23\t0.004052\n49\t0.031702\n7\t0.001644\n84\t0.002496\n87\t0.002162\n51\t0.031271\n69\t0.006635\n97\t0.001353\n63\t0.011422\n10\t0.001946\n77\t0.003621\n50\t0.031685\n45\t0.026399\n38\t0.013679\n82\t0.002737\n80\t0.003121\n73\t0.005007\n25\t0.004484\n24\t0.004178\n70\t0.006114\n62\t0.01239\n95\t0.001442\n29\t0.006099\n21\t0.003505\n98\t0.001267\n60\t0.015261\n32\t0.007891\n90\t0.001809\n75\t0.00418\n56\t0.022173\n58\t0.018392\n33\t0.008384\n11\t0.002005\n83\t0.002518\n71\t0.005729\n68\t0.007197\n14\t0.002326\n42\t0.020183\n79\t0.003328\n2\t0.001309\n30\t0.006601\n99\t0.001292\n66\t0.00867\n46\t0.02866\n67\t0.007702\n0\t0.001273\n18\t0.00284\n74\t0.004513\n36\t0.011338\n89\t0.001889\n"},{"type":"TEXT","data":"a: Double = -5.0\nb: Double = 5.0\nM: Double = 100.0\ninterval: Double = 0.1\ngroupedDf: org.apache.spark.sql.DataFrame = [int_id: int, pi_: double]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=14","http://172.17.0.2:4040/jobs/job?id=15","http://172.17.0.2:4040/jobs/job?id=16","http://172.17.0.2:4040/jobs/job?id=17","http://172.17.0.2:4040/jobs/job?id=18"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257241_-2017004517","id":"20191014-101143_1896981785","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:37:27+0000","dateFinished":"2019-10-16T17:37:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58549"},{"text":"%md \n### Calculating pointed Mode and Median","user":"anonymous","dateUpdated":"2019-10-16T17:37:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating pointed Mode and Median</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571243258787_1110111474","id":"20191016-162738_1714813113","dateCreated":"2019-10-16T16:27:38+0000","dateStarted":"2019-10-16T17:37:30+0000","dateFinished":"2019-10-16T17:37:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58550"},{"text":"val cauchyArr = cauchyDistribution.collect.map(_.getDouble(0))","user":"anonymous","dateUpdated":"2019-10-16T17:37:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cauchyArr: Array[Double] = Array(-4.01503461364025, 0.15483473459434116, -1.0028219650928136, 1.4852979342373296, -1.8931574360425825, -16.231714268560165, -0.00857537232020582, 0.19486827825480826, 0.3202343931683504, 5.36595476219063, -0.3341080159018054, 1.2243133419317829, -0.1611770804593959, 1.6034305546419096, 4.276180001657938, 3.863392283107993, 0.3984404306843134, -6.822707504316338, 5.057603899272477, -0.7546627854348821, 3.17489316470442, 2.3335866825639764, -1.8550316136253235, -3.0031265738220796, 7.96199449592471, -0.22280153538233563, -1.4969502685100182, -0.2753548745452912, -0.581634599388807, 0.8922296321896812, 0.016277953200603427, -1.6149090382436846, -0.2114450648471379, 0.5474832927083984, -0.11812576218854129, -1.2962905579230253, 0.1708360005247648, 11.01530286..."}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=19"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571245443183_-88039126","id":"20191016-170403_735218905","dateCreated":"2019-10-16T17:04:03+0000","dateStarted":"2019-10-16T17:37:31+0000","dateFinished":"2019-10-16T17:37:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58551"},{"text":"val pointed_median = median(cauchyArr)\nval pointed_mode = mode(cauchyArr, 0.0001)","user":"anonymous","dateUpdated":"2019-10-16T17:37:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pointed_median: Double = 0.8579196217659917\npointed_mode: Double = 0.12265000000000001\n"}]},"apps":[],"jobName":"paragraph_1571245851678_-491480209","id":"20191016-171051_1255840469","dateCreated":"2019-10-16T17:10:51+0000","dateStarted":"2019-10-16T17:37:32+0000","dateFinished":"2019-10-16T17:37:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58552"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571246374596_-1490618983","id":"20191016-171934_192158188","dateCreated":"2019-10-16T17:19:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:66661","text":"%md\n### Calculating interval Mode and Median","dateUpdated":"2019-10-16T17:37:34+0000","dateFinished":"2019-10-16T17:37:34+0000","dateStarted":"2019-10-16T17:37:34+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating interval Mode and Median</h3>\n</div>"}]}},{"text":"calcIntervalStatistic(cauchyArr, 10, median)","user":"anonymous","dateUpdated":"2019-10-16T17:37:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571246406837_1723198707","id":"20191016-172006_1474086445","dateCreated":"2019-10-16T17:20:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:66776","dateFinished":"2019-10-16T17:37:49+0000","dateStarted":"2019-10-16T17:37:34+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res7: (Double, Double) = (-4.362445721947396,6.078284965479379)\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571246497473_-1777394020","id":"20191016-172137_155503474","dateCreated":"2019-10-16T17:21:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:66848","text":"calcIntervalStatistic(cauchyArr, 10, (x: Array[Double]) => mode(x, 0.0001))","dateUpdated":"2019-10-16T17:37:49+0000","dateFinished":"2019-10-16T17:38:03+0000","dateStarted":"2019-10-16T17:37:49+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res8: (Double, Double) = (-0.04778073385197376,0.29308073385197375)\n"}]}},{"text":"%md \n### Pearson's chi-squared criteria:","user":"anonymous","dateUpdated":"2019-10-16T17:38:03+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Pearson&rsquo;s chi-squared criteria:</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257241_-2020640247","id":"20191014-101538_2012387827","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:03+0000","dateFinished":"2019-10-16T17:38:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58553"},{"text":"def CauchyDF(x: Double) = scala.math.atan(x) / Pi + 0.5 // Cauchy distribution function\ncalcXi2(cauchyDistribution, -5, 5, 20, CauchyDF)","user":"anonymous","dateUpdated":"2019-10-16T17:38:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"CauchyDF: (x: Double)Double\nres9: Double = 10.370554514700055\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=20","http://172.17.0.2:4040/jobs/job?id=21"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571242682096_1545563119","id":"20191016-161802_1932990354","dateCreated":"2019-10-16T16:18:02+0000","dateStarted":"2019-10-16T17:38:03+0000","dateFinished":"2019-10-16T17:38:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58554"},{"text":"%md\n## Part 3","user":"anonymous","dateUpdated":"2019-10-16T17:38:07+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Part 3</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257242_17739517","id":"20191014-120238_1283133298","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:07+0000","dateFinished":"2019-10-16T17:38:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58555"},{"text":"%md\n### Lets take a normal distribution from -n to n and generate probability and distribution function values","user":"anonymous","dateUpdated":"2019-10-16T17:38:07+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Lets take a normal distribution from -n to n and generate probability and distribution function values</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257242_1037135034","id":"20191014-125527_2061783891","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:07+0000","dateFinished":"2019-10-16T17:38:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58556"},{"text":"val n = 100\nval k = 20.0\n\ndef nd(x: Double) = {\n    ((1 / scala.math.pow(2 * Pi, 0.5)) * scala.math.exp(-scala.math.pow(x, 2)/2))\n}\nval p = (-n to n).map(i => nd(i / k)).toList\nvar s = 0.0\nval dfv = p.map(pi => {s += (pi / k); s})","user":"anonymous","dateUpdated":"2019-10-16T17:38:07+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"n: Int = 100\nk: Double = 20.0\nnd: (x: Double)Double\np: List[Double] = List(1.4867195147342977E-6, 1.9066009031228108E-6, 2.438960745893352E-6, 3.1121755791489445E-6, 3.961299091032075E-6, 5.029507288592445E-6, 6.36982517886709E-6, 8.047182456492295E-6, 1.0140852065486758E-5, 1.2747332381833466E-5, 1.5983741106905475E-5, 1.999179670692279E-5, 2.4942471290053535E-5, 3.1041407057850266E-5, 3.853519674208713E-5, 4.771863654120495E-5, 5.8943067756539855E-5, 7.262593030225232E-5, 8.926165717713293E-5, 1.0943404343980055E-4, 1.3383022576488537E-4, 1.63256408766242E-4, 1.9865547139277272E-4, 2.4112658022599324E-4, 2.9194692579146027E-4, 3.525956823674454E-4, 4.2478027055075143E-4, 5.104649743441856E-4, 6.119019301137719E-4, 7.316644628303109E-4, 8.726826950457602E-4, 0.0010382812956614103, 0.00..."}]},"apps":[],"jobName":"paragraph_1571069257243_1233292187","id":"20191014-122149_1228412350","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:07+0000","dateFinished":"2019-10-16T17:38:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58557"},{"text":"p.sum / k","user":"anonymous","dateUpdated":"2019-10-16T17:38:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res10: Double = 0.9999994979383354\n"}]},"apps":[],"jobName":"paragraph_1571069257243_1014218941","id":"20191014-122211_727421972","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:08+0000","dateFinished":"2019-10-16T17:38:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58558"},{"text":"%md\n### Probability function","user":"anonymous","dateUpdated":"2019-10-16T17:38:08+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Probability function</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257243_-303011788","id":"20191014-125745_87329235","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:08+0000","dateFinished":"2019-10-16T17:38:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58559"},{"text":"println(\"%table\\nx\\ty\")\n(0 until p.length).foreach(i => println(i + \"\\t\" + p(i)))","user":"anonymous","dateUpdated":"2019-10-16T17:38:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"x":"string","y":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"x","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"y","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"x\ty\n0\t1.4867195147342977E-6\n1\t1.9066009031228108E-6\n2\t2.438960745893352E-6\n3\t3.1121755791489445E-6\n4\t3.961299091032075E-6\n5\t5.029507288592445E-6\n6\t6.36982517886709E-6\n7\t8.047182456492295E-6\n8\t1.0140852065486758E-5\n9\t1.2747332381833466E-5\n10\t1.5983741106905475E-5\n11\t1.999179670692279E-5\n12\t2.4942471290053535E-5\n13\t3.1041407057850266E-5\n14\t3.853519674208713E-5\n15\t4.771863654120495E-5\n16\t5.8943067756539855E-5\n17\t7.262593030225232E-5\n18\t8.926165717713293E-5\n19\t1.0943404343980055E-4\n20\t1.3383022576488537E-4\n21\t1.63256408766242E-4\n22\t1.9865547139277272E-4\n23\t2.4112658022599324E-4\n24\t2.9194692579146027E-4\n25\t3.525956823674454E-4\n26\t4.2478027055075143E-4\n27\t5.104649743441856E-4\n28\t6.119019301137719E-4\n29\t7.316644628303109E-4\n30\t8.726826950457602E-4\n31\t0.0010382812956614103\n32\t0.00123221916847302\n33\t0.0014587308046667459\n34\t0.0017225689390536812\n35\t0.002029048057299768\n36\t0.0023840882014648404\n37\t0.002794258414879447\n38\t0.003266819056199918\n39\t0.0038097620982218104\n40\t0.0044318484119380075\n41\t0.005142640923053939\n42\t0.005952532419775854\n43\t0.006872766690613971\n44\t0.007915451582979969\n45\t0.009093562501591053\n46\t0.010420934814422592\n47\t0.01191224360760518\n48\t0.013582969233685613\n49\t0.015449347134395174\n50\t0.01752830049356854\n51\t0.019837354391795313\n52\t0.0223945302948429\n53\t0.025218219915194382\n54\t0.028327037741601186\n55\t0.03173965183566742\n56\t0.035474592846231424\n57\t0.03955004158937022\n58\t0.04398359598042719\n59\t0.048792018579182764\n60\t0.05399096651318806\n61\t0.059594706068816075\n62\t0.0656158147746766\n63\t0.07206487433621798\n64\t0.07895015830089415\n65\t0.08627731882651153\n66\t0.09404907737688695\n67\t0.10226492456397804\n68\t0.11092083467945554\n69\t0.12000900069698558\n70\t0.12951759566589174\n71\t0.13943056644536028\n72\t0.14972746563574488\n73\t0.1603833273419196\n74\t0.17136859204780736\n75\t0.18264908538902191\n76\t0.19418605498321295\n77\t0.20593626871997478\n78\t0.21785217703255053\n79\t0.22988214068423302\n80\t0.24197072451914337\n81\t0.254059056469189\n82\t0.2660852498987548\n83\t0.2779848861309965\n84\t0.28969155276148273\n85\t0.30113743215480443\n86\t0.31225393336676127\n87\t0.32297235966791427\n88\t0.33322460289179967\n89\t0.3429438550193839\n90\t0.3520653267642995\n91\t0.36052696246164795\n92\t0.36827014030332333\n93\t0.3752403469169379\n94\t0.38138781546052414\n95\t0.38666811680284924\n96\t0.3910426939754559\n97\t0.39447933090788895\n98\t0.3969525474770118\n99\t0.39844391409476404\n100\t0.3989422804014327\n101\t0.39844391409476404\n102\t0.3969525474770118\n103\t0.39447933090788895\n104\t0.3910426939754559\n105\t0.38666811680284924\n106\t0.38138781546052414\n107\t0.3752403469169379\n108\t0.36827014030332333\n109\t0.36052696246164795\n110\t0.3520653267642995\n111\t0.3429438550193839\n112\t0.33322460289179967\n113\t0.32297235966791427\n114\t0.31225393336676127\n115\t0.30113743215480443\n116\t0.28969155276148273\n117\t0.2779848861309965\n118\t0.2660852498987548\n119\t0.254059056469189\n120\t0.24197072451914337\n121\t0.22988214068423302\n122\t0.21785217703255053\n123\t0.20593626871997478\n124\t0.19418605498321295\n125\t0.18264908538902191\n126\t0.17136859204780736\n127\t0.1603833273419196\n128\t0.14972746563574488\n129\t0.13943056644536028\n130\t0.12951759566589174\n131\t0.12000900069698558\n132\t0.11092083467945554\n133\t0.10226492456397804\n134\t0.09404907737688695\n135\t0.08627731882651153\n136\t0.07895015830089415\n137\t0.07206487433621798\n138\t0.0656158147746766\n139\t0.059594706068816075\n140\t0.05399096651318806\n141\t0.048792018579182764\n142\t0.04398359598042719\n143\t0.03955004158937022\n144\t0.035474592846231424\n145\t0.03173965183566742\n146\t0.028327037741601186\n147\t0.025218219915194382\n148\t0.0223945302948429\n149\t0.019837354391795313\n150\t0.01752830049356854\n151\t0.015449347134395174\n152\t0.013582969233685613\n153\t0.01191224360760518\n154\t0.010420934814422592\n155\t0.009093562501591053\n156\t0.007915451582979969\n157\t0.006872766690613971\n158\t0.005952532419775854\n159\t0.005142640923053939\n160\t0.0044318484119380075\n161\t0.0038097620982218104\n162\t0.003266819056199918\n163\t0.002794258414879447\n164\t0.0023840882014648404\n165\t0.002029048057299768\n166\t0.0017225689390536812\n167\t0.0014587308046667459\n168\t0.00123221916847302\n169\t0.0010382812956614103\n170\t8.726826950457602E-4\n171\t7.316644628303109E-4\n172\t6.119019301137719E-4\n173\t5.104649743441856E-4\n174\t4.2478027055075143E-4\n175\t3.525956823674454E-4\n176\t2.9194692579146027E-4\n177\t2.4112658022599324E-4\n178\t1.9865547139277272E-4\n179\t1.63256408766242E-4\n180\t1.3383022576488537E-4\n181\t1.0943404343980055E-4\n182\t8.926165717713293E-5\n183\t7.262593030225232E-5\n184\t5.8943067756539855E-5\n185\t4.771863654120495E-5\n186\t3.853519674208713E-5\n187\t3.1041407057850266E-5\n188\t2.4942471290053535E-5\n189\t1.999179670692279E-5\n190\t1.5983741106905475E-5\n191\t1.2747332381833466E-5\n192\t1.0140852065486758E-5\n193\t8.047182456492295E-6\n194\t6.36982517886709E-6\n195\t5.029507288592445E-6\n196\t3.961299091032075E-6\n197\t3.1121755791489445E-6\n198\t2.438960745893352E-6\n199\t1.9066009031228108E-6\n200\t1.4867195147342977E-6\n"}]},"apps":[],"jobName":"paragraph_1571069257243_-1395161328","id":"20191014-122221_1100115833","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:08+0000","dateFinished":"2019-10-16T17:38:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58560"},{"text":"%md\n### Distribution function","user":"anonymous","dateUpdated":"2019-10-16T17:38:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Distribution function</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257244_-1536562989","id":"20191014-125910_2119465031","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:09+0000","dateFinished":"2019-10-16T17:38:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58561"},{"text":"println(\"%table\\nx\\ty\")\n(0 until p.length).foreach(i => println(i + \"\\t\" + p.take(i + 1).sum / k))","user":"anonymous","dateUpdated":"2019-10-16T17:38:27+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"x":"string","y":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"x","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"y","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"x\ty\n0\t7.433597573671489E-8\n1\t1.6966602089285542E-7\n2\t2.9161405818752304E-7\n3\t4.4722283714497024E-7\n4\t6.45287791696574E-7\n5\t8.967631561261963E-7\n6\t1.2152544150695507E-6\n7\t1.6176135378941655E-6\n8\t2.1246561411685034E-6\n9\t2.7620227602601767E-6\n10\t3.5612098156054503E-6\n11\t4.56079965095159E-6\n12\t5.807923215454266E-6\n13\t7.35999356834678E-6\n14\t9.286753405451137E-6\n15\t1.1672685232511384E-5\n16\t1.4619838620338378E-5\n17\t1.8251135135450995E-5\n18\t2.271421799430764E-5\n19\t2.8185920166297665E-5\n20\t3.487743145454193E-5\n21\t4.304025189285403E-5\n22\t5.2973025462492665E-5\n23\t6.502935447379234E-5\n24\t7.962670076336534E-5\n25\t9.725648488173762E-5\n26\t1.1849549840927519E-4\n27\t1.4401874712648447E-4\n28\t1.7461384363217308E-4\n29\t2.1119706677368862E-4\n30\t2.5483120152597664E-4\n31\t3.0674526630904717E-4\n32\t3.6835622473269813E-4\n33\t4.412927649660355E-4\n34\t5.274212119187195E-4\n35\t6.288736147837079E-4\n36\t7.480780248569499E-4\n37\t8.877909456009223E-4\n38\t0.0010511318984109182\n39\t0.0012416200033220086\n40\t0.001463212423918909\n41\t0.001720344470071606\n42\t0.0020179710910603987\n43\t0.0023616094255910973\n44\t0.0027573820047400955\n45\t0.003212060129819648\n46\t0.0037331068705407774\n47\t0.0043287190509210365\n48\t0.005007867512605317\n49\t0.005780334869325076\n50\t0.006656749894003502\n51\t0.007648617613593268\n52\t0.008768344128335413\n53\t0.010029255124095133\n54\t0.011445607011175193\n55\t0.013032589602958564\n56\t0.014806319245270136\n57\t0.016783821324738647\n58\t0.018983001123760005\n59\t0.02142260205271914\n60\t0.024122150378378546\n61\t0.02710188568181935\n62\t0.03038267642055318\n63\t0.03398592013736408\n64\t0.037933428052408784\n65\t0.042247293993734364\n66\t0.04694974786257871\n67\t0.052062994090777616\n68\t0.05760903582475039\n69\t0.06360948585959966\n70\t0.07008536564289426\n71\t0.07705689396516227\n72\t0.08454326724694952\n73\t0.0925624336140455\n74\t0.10113086321643586\n75\t0.11026331748588696\n76\t0.1199726202350476\n77\t0.13026943367104632\n78\t0.14116204252267386\n79\t0.1526561495568855\n80\t0.16475468578284266\n81\t0.17745763860630212\n82\t0.19076190110123986\n83\t0.2046611454077897\n84\t0.21914572304586385\n85\t0.23420259465360407\n86\t0.2498152913219421\n87\t0.2659639093053378\n88\t0.28262513944992784\n89\t0.29977233220089705\n90\t0.317375598539112\n91\t0.3354019466621944\n92\t0.3538154536773606\n93\t0.3725774710232075\n94\t0.3916468617962337\n95\t0.4109802676363762\n96\t0.43053240233514894\n97\t0.4502563688805433\n98\t0.4701039962543939\n99\t0.49002619195913216\n100\t0.5099733059792039\n101\t0.5298955016839421\n102\t0.5497431290577927\n103\t0.5694670956031871\n104\t0.5890192303019599\n105\t0.6083526361421023\n106\t0.6274220269151285\n107\t0.6461840442609754\n108\t0.6645975512761415\n109\t0.682623899399224\n110\t0.7002271657374389\n111\t0.717374358488408\n112\t0.7340355886329981\n113\t0.7501842066163938\n114\t0.7657969032847319\n115\t0.7808537748924722\n116\t0.7953383525305463\n117\t0.8092375968370961\n118\t0.8225418593320338\n119\t0.8352448121554932\n120\t0.8473433483814503\n121\t0.8588374554156619\n122\t0.8697300642672895\n123\t0.8800268777032881\n124\t0.8897361804524488\n125\t0.8988686347218999\n126\t0.9074370643242903\n127\t0.9154562306913862\n128\t0.9229426039731734\n129\t0.9299141322954414\n130\t0.936390012078736\n131\t0.9423904621135852\n132\t0.947936503847558\n133\t0.9530497500757569\n134\t0.9577522039446013\n135\t0.9620660698859268\n136\t0.9660135778009715\n137\t0.9696168215177824\n138\t0.9728976122565163\n139\t0.975877347559957\n140\t0.9785768958856164\n141\t0.9810164968145754\n142\t0.9832156766135969\n143\t0.9851931786930652\n144\t0.9869669083353768\n145\t0.9885538909271603\n146\t0.9899702428142403\n147\t0.99123115381\n148\t0.9923508803247423\n149\t0.9933427480443321\n150\t0.9942191630690106\n151\t0.9949916304257304\n152\t0.9956707788874146\n153\t0.9962663910677948\n154\t0.996787437808516\n155\t0.9972421159335955\n156\t0.9976378885127446\n157\t0.9979815268472751\n158\t0.998279153468264\n159\t0.9985362855144168\n160\t0.9987578779350136\n161\t0.9989483660399247\n162\t0.9991117069927347\n163\t0.9992514199134787\n164\t0.9993706243235518\n165\t0.9994720767264168\n166\t0.9995582051733696\n167\t0.9996311417136029\n168\t0.9996927526720265\n169\t0.9997446667368095\n170\t0.9997883008715618\n171\t0.9998248840947033\n172\t0.999855479191209\n173\t0.9998810024399262\n174\t0.9999022414534536\n175\t0.9999198712375721\n176\t0.9999344685838617\n177\t0.999946524912873\n178\t0.9999564576864426\n179\t0.9999646205068808\n180\t0.999971312018169\n181\t0.999976783720341\n182\t0.9999812468031999\n183\t0.9999848780997149\n184\t0.9999878252531028\n185\t0.9999902111849298\n186\t0.999992137944767\n187\t0.99999369001512\n188\t0.9999949371386844\n189\t0.9999959367285196\n190\t0.999996735915575\n191\t0.9999973732821941\n192\t0.9999978803247973\n193\t0.9999982826839202\n194\t0.9999986011751792\n195\t0.9999988526505437\n196\t0.9999990507154981\n197\t0.9999992063242772\n198\t0.9999993282723144\n199\t0.9999994236023596\n200\t0.9999994979383354\n"}]},"apps":[],"jobName":"paragraph_1571069257244_-1409006420","id":"20191014-122231_1838399354","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:09+0000","dateFinished":"2019-10-16T17:38:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58562"},{"text":"dfv.size","user":"anonymous","dateUpdated":"2019-10-16T17:38:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res13: Int = 201\n"}]},"apps":[],"jobName":"paragraph_1571069257245_-316110962","id":"20191014-122243_1877199398","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:10+0000","dateFinished":"2019-10-16T17:38:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58563"},{"text":"%md\n### Generating a sample for N values from a to b","user":"anonymous","dateUpdated":"2019-10-16T17:38:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Generating a sample for N values from a to b</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257245_1888878362","id":"20191014-125057_817812560","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:10+0000","dateFinished":"2019-10-16T17:38:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58564"},{"text":"val N = 100000\nval (a, b) = (0.0, 200.0)","user":"anonymous","dateUpdated":"2019-10-16T17:38:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"N: Int = 100000\na: Double = 0.0\nb: Double = 200.0\n"}]},"apps":[],"jobName":"paragraph_1571069257245_-1022956474","id":"20191014-125116_792364804","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:10+0000","dateFinished":"2019-10-16T17:38:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58565"},{"text":"dfv.count(_ <= 0.5)","user":"anonymous","dateUpdated":"2019-10-16T17:38:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res14: Int = 100\n"}]},"apps":[],"jobName":"paragraph_1571233945707_521021739","id":"20191016-135225_65098156","dateCreated":"2019-10-16T13:52:25+0000","dateStarted":"2019-10-16T17:38:11+0000","dateFinished":"2019-10-16T17:38:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58566"},{"text":"val res: List[Double] = (0 until N).map(i => dfv.count(_ <= random.next).toDouble * (b - a) / (2 * n) + a).toList","user":"anonymous","dateUpdated":"2019-10-16T17:38:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res: List[Double] = List(98.0, 100.0, 100.0, 102.0, 101.0, 93.0, 98.0, 108.0, 98.0, 97.0, 100.0, 102.0, 102.0, 100.0, 103.0, 104.0, 107.0, 100.0, 102.0, 106.0, 96.0, 97.0, 96.0, 100.0, 101.0, 99.0, 99.0, 100.0, 102.0, 103.0, 95.0, 103.0, 97.0, 103.0, 94.0, 97.0, 100.0, 101.0, 99.0, 96.0, 99.0, 97.0, 106.0, 94.0, 94.0, 101.0, 105.0, 104.0, 97.0, 102.0, 99.0, 100.0, 99.0, 103.0, 97.0, 101.0, 102.0, 105.0, 96.0, 90.0, 94.0, 102.0, 98.0, 100.0, 98.0, 105.0, 99.0, 97.0, 97.0, 99.0, 97.0, 102.0, 104.0, 100.0, 98.0, 96.0, 103.0, 102.0, 100.0, 100.0, 105.0, 103.0, 98.0, 102.0, 100.0, 101.0, 96.0, 105.0, 104.0, 96.0, 100.0, 97.0, 99.0, 102.0, 100.0, 99.0, 97.0, 105.0, 101.0, 102.0, 101.0, 103.0, 104.0, 98.0, 96.0, 95.0, 106.0, 100.0, 97.0, 99.0, 96.0, 102.0, 100.0, 100.0, 98.0, 99.0, 101.0, 99.0..."}]},"apps":[],"jobName":"paragraph_1571069257246_841572519","id":"20191014-122305_1506052187","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:11+0000","dateFinished":"2019-10-16T17:38:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58567"},{"text":"%md\n### Drawing a histogram","user":"anonymous","dateUpdated":"2019-10-16T17:38:19+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Drawing a histogram</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257246_-1940363557","id":"20191014-130027_294373302","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:19+0000","dateFinished":"2019-10-16T17:38:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58568"},{"text":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\n\nval df = spark.createDataFrame(\n    spark.sparkContext.parallelize(res).map(t => Row(t)), \n    StructType(\n        Seq(\n            StructField(\"value\", DataTypes.DoubleType, false)\n            )\n    )\n)\n\nz.show(df.withColumn(\"value\", 'value).groupBy('value).count)","user":"anonymous","dateUpdated":"2019-10-16T17:38:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"value":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"value","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"value\tcount\n112.0\t14\n108.0\t691\n88.0\t13\n101.0\t11206\n98.0\t10078\n107.0\t1366\n96.0\t5748\n86.0\t1\n104.0\t5953\n94.0\t2385\n114.0\t2\n85.0\t1\n113.0\t4\n93.0\t1335\n103.0\t7911\n106.0\t2453\n109.0\t307\n111.0\t52\n87.0\t4\n115.0\t2\n99.0\t11387\n95.0\t3874\n100.0\t12002\n102.0\t9848\n92.0\t691\n97.0\t8112\n105.0\t3877\n89.0\t62\n90.0\t129\n91.0\t346\n110.0\t146\n"},{"type":"TEXT","data":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\ndf: org.apache.spark.sql.DataFrame = [value: double]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=22","http://172.17.0.2:4040/jobs/job?id=23","http://172.17.0.2:4040/jobs/job?id=24","http://172.17.0.2:4040/jobs/job?id=25","http://172.17.0.2:4040/jobs/job?id=26"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257246_477274542","id":"20191014-122315_2064418733","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:19+0000","dateFinished":"2019-10-16T17:38:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58569"},{"text":"%md\n### Calculating pointed Mean and Deviation","user":"anonymous","dateUpdated":"2019-10-16T17:38:21+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating pointed Mean and Deviation</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257246_-1308977150","id":"20191014-130125_1633773100","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:21+0000","dateFinished":"2019-10-16T17:38:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58570"},{"text":"val EV = df.select(avg('value)).first.getDouble(0)\nval EV2 = scala.math.pow(EV, 2)\n\nval D2 = df.select(avg(pow('value, 2) - EV2)).first.getDouble(0)\nscala.math.pow(D2, 0.5)","user":"anonymous","dateUpdated":"2019-10-16T17:38:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"EV: Double = 99.99966\nEV2: Double = 9999.932000115601\nD2: Double = 11.231499884387638\nres16: Double = 3.3513429971263218\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=27","http://172.17.0.2:4040/jobs/job?id=28"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1571069257247_1323353160","id":"20191014-122325_1306908467","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:21+0000","dateFinished":"2019-10-16T17:38:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58571"},{"text":"%md\n### Calculating interval Mean and Variance intervals","user":"anonymous","dateUpdated":"2019-10-16T17:38:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Calculating interval Mean and Variance intervals</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257247_374040768","id":"20191014-130213_1692483387","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:22+0000","dateFinished":"2019-10-16T17:38:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58572"},{"user":"anonymous","dateUpdated":"2019-10-16T17:38:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571069257248_1672456177","id":"20191014-122351_1090714781","dateCreated":"2019-10-14T16:07:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58573","text":"val intervalMean = calcIntervalStatistic(res.toArray, 10, mean)","dateFinished":"2019-10-16T17:38:24+0000","dateStarted":"2019-10-16T17:38:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"intervalMean: (Double, Double) = (99.98820395796213,100.01111604203788)\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571247183308_1759322840","id":"20191016-173303_1138335405","dateCreated":"2019-10-16T17:33:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:67221","text":"val intervalVariance = calcIntervalStatistic(res.toArray, 10, variance)","dateUpdated":"2019-10-16T17:38:24+0000","dateFinished":"2019-10-16T17:38:25+0000","dateStarted":"2019-10-16T17:38:24+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"intervalVariance: (Double, Double) = (11.190175644971625,11.272824123827231)\n"}]}},{"text":"%md \n### Pearson's chi-squared criteria:","user":"anonymous","dateUpdated":"2019-10-16T17:38:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Pearson&rsquo;s chi-squared criteria:</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1571069257248_1540145116","id":"20191014-130250_724854181","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:25+0000","dateFinished":"2019-10-16T17:38:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58574"},{"text":"val (a, b) = (90.0, 110.0)\nval M = 20\nval interval = (b - a) / M\n\nval groupedDf = df.filter('value > a && 'value < b).withColumn(\"int_id\", (('value - a) / interval).cast(IntegerType)).groupBy('int_id).agg((count(\"*\") / N.toDouble).as(\"pi_\"))\n// val xi2 = N * groupedDf.agg(sum(pow('pi_ - pi('int_id), 2) / pi('int_id))).first.getDouble(0)","user":"anonymous","dateUpdated":"2019-10-16T17:38:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"int_id":"string","pi_":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"int_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"pi_","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"a: Double = 90.0\nb: Double = 110.0\nM: Int = 20\ninterval: Double = 1.0\ngroupedDf: org.apache.spark.sql.DataFrame = [int_id: int, pi_: double]\n"}]},"apps":[],"jobName":"paragraph_1571069257249_-1425124440","id":"20191014-130320_1715351855","dateCreated":"2019-10-14T16:07:37+0000","dateStarted":"2019-10-16T17:38:25+0000","dateFinished":"2019-10-16T17:38:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58575"},{"user":"anonymous","dateUpdated":"2019-10-16T16:12:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571069257249_-1073805521","id":"20191014-131409_1631994440","dateCreated":"2019-10-14T16:07:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:58576"}],"name":"MMOD: Lab1","id":"2ERWXTN37","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}