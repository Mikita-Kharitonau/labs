{"paragraphs":[{"text":"%md\n## MMOD: Lab1 Базовая случайная величина. Генерация непрерывных и дискретных случайных величин.","user":"anonymous","dateUpdated":"2019-10-13T20:25:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>MMOD: Lab1 Базовая случайная величина. Генерация непрерывных и дискретных случайных величин.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1570896595022_1379341382","id":"20191012-160955_881587067","dateCreated":"2019-10-12T16:09:55+0000","dateStarted":"2019-10-13T20:25:11+0000","dateFinished":"2019-10-13T20:25:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10079"},{"text":"%md\n## Part 1.","user":"anonymous","dateUpdated":"2019-10-13T20:25:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Part 1.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1570896631244_-1855558313","id":"20191012-161031_540723432","dateCreated":"2019-10-12T16:10:31+0000","dateStarted":"2019-10-13T20:25:11+0000","dateFinished":"2019-10-13T20:25:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10080"},{"text":"%md\nPreparing util functions","user":"anonymous","dateUpdated":"2019-10-13T20:25:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Preparing util functions</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1570896836171_376654118","id":"20191012-161356_135676605","dateCreated":"2019-10-12T16:13:56+0000","dateStarted":"2019-10-13T20:25:11+0000","dateFinished":"2019-10-13T20:25:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10081"},{"text":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\n\nclass LinearCongruentGenerator(m: BigInt = BigInt(\"34359738368\"),\n                               k: BigInt = BigInt(\"152587890625\"),\n                               A0: BigInt = 999) extends Serializable {\n\n  var prevValue: BigInt = A0\n\n  def next: Double = {\n    val result: BigInt = (k * prevValue) % m\n    prevValue = result\n    result.toDouble / m.toDouble\n  }\n}\n\nval random = new LinearCongruentGenerator\n\ndef randomDf(range: Int, random: LinearCongruentGenerator, columnName: String = \"value\") = {\n    spark.createDataFrame(\n        spark.sparkContext.parallelize((0 until range).map(i => random.next)).map(t => Row(t)), \n        StructType(\n            Seq(\n                StructField(columnName, DataTypes.DoubleType, false)\n            )\n        )\n    )\n}","user":"anonymous","dateUpdated":"2019-10-13T20:25:12+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\ndefined class LinearCongruentGenerator\nrandom: LinearCongruentGenerator = LinearCongruentGenerator@75c54105\nrandomDf: (range: Int, random: LinearCongruentGenerator, columnName: String)org.apache.spark.sql.DataFrame\n"}]},"apps":[],"jobName":"paragraph_1570548135722_1555872379","id":"20191001-084552_364857475","dateCreated":"2019-10-08T15:22:15+0000","dateStarted":"2019-10-13T20:25:12+0000","dateFinished":"2019-10-13T20:25:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10082"},{"text":"%md\nConstants","user":"anonymous","dateUpdated":"2019-10-13T20:25:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Constants</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1570896904955_1817961395","id":"20191012-161504_1431968683","dateCreated":"2019-10-12T16:15:04+0000","dateStarted":"2019-10-13T20:25:32+0000","dateFinished":"2019-10-13T20:25:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10083"},{"text":"val N = 1000000 // Sample size\nval M = 20 // Bins count","user":"anonymous","dateUpdated":"2019-10-13T20:25:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"N: Int = 1000000\nM: Int = 20\n"}]},"apps":[],"jobName":"paragraph_1570897036219_-728642427","id":"20191012-161716_1721258311","dateCreated":"2019-10-12T16:17:16+0000","dateStarted":"2019-10-13T20:25:32+0000","dateFinished":"2019-10-13T20:25:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10084"},{"text":"%md\nCreating a sample","user":"anonymous","dateUpdated":"2019-10-13T20:25:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Creating a sample</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1570897057354_-157710569","id":"20191012-161737_1519390953","dateCreated":"2019-10-12T16:17:37+0000","dateStarted":"2019-10-13T20:25:33+0000","dateFinished":"2019-10-13T20:25:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10085"},{"text":"val df = randomDf(N, random)\ndf.show(10)","user":"anonymous","dateUpdated":"2019-10-13T20:25:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+\n|              value|\n+-------------------+\n|0.45120640212553553|\n| 0.8309834033425432|\n| 0.4222366113390308|\n| 0.8706645734782796|\n|  0.966008805873571|\n|  0.423303793388186|\n| 0.6641269896354061|\n| 0.5978488169785123|\n| 0.4028826665307861|\n|0.30793489815550856|\n+-------------------+\nonly showing top 10 rows\n\ndf: org.apache.spark.sql.DataFrame = [value: double]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1570891505263_1135615004","id":"20191012-144505_885667887","dateCreated":"2019-10-12T14:45:05+0000","dateStarted":"2019-10-13T20:25:33+0000","dateFinished":"2019-10-13T20:25:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10086"},{"text":"%md\nDrawing histogram with M bins","user":"anonymous","dateUpdated":"2019-10-13T20:25:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Drawing histogram with M bins</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1570897106892_256160804","id":"20191012-161826_232387597","dateCreated":"2019-10-12T16:18:26+0000","dateStarted":"2019-10-13T20:25:37+0000","dateFinished":"2019-10-13T20:25:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10087"},{"text":"import org.apache.spark.sql.types.IntegerType\nz.show(df.withColumn(\"int_id\", ('value * M).cast(IntegerType)).groupBy(\"int_id\").agg((count(\"*\") / N).as(\"p\")))","user":"anonymous","dateUpdated":"2019-10-13T20:25:56+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"int_id":"string","p":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"int_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"p","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"int_id\tp\n12\t0.050216\n1\t0.050111\n13\t0.050077\n16\t0.049809\n6\t0.049648\n3\t0.04977\n5\t0.049963\n19\t0.049961\n15\t0.049901\n9\t0.050443\n17\t0.050058\n4\t0.050231\n8\t0.049869\n7\t0.050446\n10\t0.049543\n11\t0.049899\n14\t0.049966\n2\t0.049851\n0\t0.050082\n18\t0.050156\n"},{"type":"TEXT","data":"import org.apache.spark.sql.types.IntegerType\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1","http://172.17.0.2:4040/jobs/job?id=2","http://172.17.0.2:4040/jobs/job?id=3","http://172.17.0.2:4040/jobs/job?id=4","http://172.17.0.2:4040/jobs/job?id=5"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1570548135725_997150955","id":"20191001-085208_579427695","dateCreated":"2019-10-08T15:22:15+0000","dateStarted":"2019-10-13T20:25:37+0000","dateFinished":"2019-10-13T20:25:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10088"},{"text":"%md\nCalculating pointed Mean and Deviation","user":"anonymous","dateUpdated":"2019-10-13T20:25:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Calculating pointed Mean and Deviation</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1570897877716_-1981430478","id":"20191012-163117_1936812781","dateCreated":"2019-10-12T16:31:17+0000","dateStarted":"2019-10-13T20:25:42+0000","dateFinished":"2019-10-13T20:25:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10089"},{"text":"val EV = df.agg(avg('value)).first.getDouble(0)\nval EV2 = scala.math.pow(EV, 2)\nval D = df.agg(avg(pow('value, 2) - EV2)).first.getDouble(0)","user":"anonymous","dateUpdated":"2019-10-13T20:25:42+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"EV: Double = 0.4999906065594074\nEV2: Double = 0.24999060664764414\nD: Double = 0.08335051769541778\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=6","http://172.17.0.2:4040/jobs/job?id=7"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1570548135726_1686452871","id":"20191001-093930_847132398","dateCreated":"2019-10-08T15:22:15+0000","dateStarted":"2019-10-13T20:25:42+0000","dateFinished":"2019-10-13T20:25:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10090"},{"text":"%md\nCalculating interval Mean and Deviation","user":"anonymous","dateUpdated":"2019-10-13T20:25:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Calculating interval Mean and Deviation</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1570987359650_-1085911579","id":"20191013-172239_763410667","dateCreated":"2019-10-13T17:22:39+0000","dateStarted":"2019-10-13T20:25:44+0000","dateFinished":"2019-10-13T20:25:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10091"},{"text":"val b = 0.95\nval l = (1 + b) / 2 // 2.25\nval e = 2.25 * scala.math.pow(D, 0.5) / scala.math.pow(N, 0.5)\nval IEV = (EV - e, EV + e)","user":"anonymous","dateUpdated":"2019-10-13T20:25:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"b: Double = 0.95\nl: Double = 0.975\ne: Double = 6.495860188097128E-4\nIEV: (Double, Double) = (0.4993410205405977,0.5006401925782171)\n"}]},"apps":[],"jobName":"paragraph_1570987368247_1622866410","id":"20191013-172248_1503177967","dateCreated":"2019-10-13T17:22:48+0000","dateStarted":"2019-10-13T20:25:44+0000","dateFinished":"2019-10-13T20:25:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10092"},{"text":"%md Calculating correlation","user":"anonymous","dateUpdated":"2019-10-13T20:25:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Calculating correlation</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1570986034767_-26209426","id":"20191013-170034_865274919","dateCreated":"2019-10-13T17:00:34+0000","dateStarted":"2019-10-13T20:25:45+0000","dateFinished":"2019-10-13T20:25:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10093"},{"text":"val df2 = randomDf(N, random, \"value2\") // Generating a second one sample\ndf2.show\n\nval dfid = df.withColumn(\"id\", monotonically_increasing_id)\nval dfid2 = df2.withColumn(\"id\", monotonically_increasing_id)\n\nval joined = dfid.join(dfid2, dfid.col(\"id\") === dfid2.col(\"id\"))\nval R = joined.agg((avg('value * 'value2) * 12) - 3).first.getDouble(0)","user":"anonymous","dateUpdated":"2019-10-13T20:25:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+\n|             value2|\n+-------------------+\n| 0.3053324978973251|\n|0.41508233846980147|\n| 0.7992966670717578|\n|0.07242403106647544|\n| 0.9929559465672355|\n|0.24467689843731932|\n| 0.2179143402900081|\n| 0.7907886944885831|\n|0.11046335214632563|\n|0.37439467312651686|\n| 0.6115819860424381|\n| 0.4638175882573705|\n| 0.9669367458845954|\n| 0.3320676937873941|\n| 0.7268816355790477|\n|0.05684274362283759|\n| 0.7464581590320449|\n|  0.520527991669951|\n|0.18539532014983706|\n|0.41019619183498435|\n+-------------------+\nonly showing top 20 rows\n\ndf2: org.apache.spark.sql.DataFrame = [value2: double]\ndfid: org.apache.spark.sql.DataFrame = [value: double, id: bigint]\ndfid2: org.apache.spark.sql.DataFrame = [value2: double, id: bigint]\njoined: org.apache.spark.sql.DataFrame = [value: double, id: bigint ... 2 more fields]\nR: Double = -0.0037964175726394878\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=8","http://172.17.0.2:4040/jobs/job?id=9"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1570548135726_1870394903","id":"20191001-103352_1088882450","dateCreated":"2019-10-08T15:22:15+0000","dateStarted":"2019-10-13T20:25:45+0000","dateFinished":"2019-10-13T20:25:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10094"},{"text":"%md Pearson's chi-squared criteria:","user":"anonymous","dateUpdated":"2019-10-13T20:25:52+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Pearson&rsquo;s chi-squared criteria:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1570548135726_1856812122","id":"20191001-103423_951730408","dateCreated":"2019-10-08T15:22:15+0000","dateStarted":"2019-10-13T20:25:52+0000","dateFinished":"2019-10-13T20:25:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10095"},{"text":"val pi = 1.0 / M\nval groupedDf = df.withColumn(\"int_id\", ('value * M).cast(IntegerType)).groupBy(\"int_id\").agg((count(\"*\") / N).as(\"pi_\"))\nval xi2 = N * groupedDf.agg(sum(pow('pi_ - pi, 2) / pi)).first.getDouble(0)\n// xi2(a, k = 20 - 1) > 34.8\nxi2 < 34.8","user":"anonymous","dateUpdated":"2019-10-13T20:25:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=10"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1570986246631_682787278","id":"20191013-170406_131134035","dateCreated":"2019-10-13T17:04:06+0000","dateStarted":"2019-10-13T20:25:52+0000","dateFinished":"2019-10-13T20:25:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10096","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pi: Double = 0.05\ngroupedDf: org.apache.spark.sql.DataFrame = [int_id: int, pi_: double]\nxi2: Double = 20.66800000000006\nres3: Boolean = true\n"}]}},{"text":"%md\n## Part 2.","user":"anonymous","dateUpdated":"2019-10-13T20:25:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Part 2.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1570986534925_-1985442538","id":"20191013-170854_1297281925","dateCreated":"2019-10-13T17:08:54+0000","dateStarted":"2019-10-13T20:25:55+0000","dateFinished":"2019-10-13T20:25:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10097"},{"text":"import scala.math.{tan, Pi}\n\ndef G(x: Double) = tan(Pi * (x - 0.5))","user":"anonymous","dateUpdated":"2019-10-13T20:25:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.math.{tan, Pi}\nG: (x: Double)Double\n"}]},"apps":[],"jobName":"paragraph_1570995787804_1145114164","id":"20191013-194307_1299559140","dateCreated":"2019-10-13T19:43:07+0000","dateStarted":"2019-10-13T20:25:55+0000","dateFinished":"2019-10-13T20:25:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10098"},{"text":"val N = 100","user":"anonymous","dateUpdated":"2019-10-13T20:25:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1570996757968_1199230335","id":"20191013-195917_1880456438","dateCreated":"2019-10-13T19:59:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10099","dateFinished":"2019-10-13T20:25:55+0000","dateStarted":"2019-10-13T20:25:55+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"N: Int = 100\n"}]}},{"text":"val Gudf = udf(G(_:Double):Double)\nval (startValues,counts) = randomDf(N, random).select(Gudf('value)).map(row => row.getDouble(0)).rdd.histogram(500)","user":"anonymous","dateUpdated":"2019-10-13T20:30:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Gudf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,DoubleType,Some(List(DoubleType)))\nstartValues: Array[Double] = Array(-62.01107201708796, -61.691274430190205, -61.37147684329244, -61.051679256394685, -60.73188166949693, -60.412084082599165, -60.09228649570141, -59.77248890880365, -59.45269132190589, -59.13289373500813, -58.813096148110375, -58.49329856121261, -58.173500974314855, -57.8537033874171, -57.533905800519335, -57.21410821362158, -56.89431062672382, -56.57451303982606, -56.2547154529283, -55.934917866030545, -55.61512027913278, -55.295322692235025, -54.97552510533727, -54.655727518439505, -54.33592993154175, -54.01613234464399, -53.69633475774623, -53.37653717084847, -53.056739583950716, -52.73694199705295, -52.417144410155196, -52.0..."}]},"apps":[],"jobName":"paragraph_1570996518432_-1418574805","id":"20191013-195518_42234506","dateCreated":"2019-10-13T19:55:18+0000","dateStarted":"2019-10-13T20:30:16+0000","dateFinished":"2019-10-13T20:30:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10100","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=19","http://172.17.0.2:4040/jobs/job?id=20"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"startPoint":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"startPoint","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1570996912611_-1002032599","id":"20191013-200152_482619910","dateCreated":"2019-10-13T20:01:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10101","dateUpdated":"2019-10-13T20:30:31+0000","dateFinished":"2019-10-13T20:30:29+0000","dateStarted":"2019-10-13T20:30:28+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"startPoint\tcount\n-62.01107201708796\t1\n-61.691274430190205\t0\n-61.37147684329244\t0\n-61.051679256394685\t0\n-60.73188166949693\t0\n-60.412084082599165\t0\n-60.09228649570141\t0\n-59.77248890880365\t0\n-59.45269132190589\t0\n-59.13289373500813\t0\n-58.813096148110375\t0\n-58.49329856121261\t0\n-58.173500974314855\t0\n-57.8537033874171\t0\n-57.533905800519335\t0\n-57.21410821362158\t0\n-56.89431062672382\t0\n-56.57451303982606\t0\n-56.2547154529283\t0\n-55.934917866030545\t0\n-55.61512027913278\t0\n-55.295322692235025\t0\n-54.97552510533727\t0\n-54.655727518439505\t0\n-54.33592993154175\t0\n-54.01613234464399\t0\n-53.69633475774623\t0\n-53.37653717084847\t0\n-53.056739583950716\t0\n-52.73694199705295\t0\n-52.417144410155196\t0\n-52.09734682325744\t0\n-51.777549236359675\t0\n-51.45775164946192\t0\n-51.13795406256416\t0\n-50.8181564756664\t0\n-50.49835888876864\t0\n-50.178561301870886\t0\n-49.85876371497312\t0\n-49.538966128075366\t0\n-49.21916854117761\t0\n-48.899370954279846\t0\n-48.57957336738209\t0\n-48.25977578048433\t0\n-47.93997819358657\t0\n-47.62018060668881\t0\n-47.300383019791056\t0\n-46.98058543289329\t0\n-46.660787845995536\t0\n-46.34099025909778\t0\n-46.021192672200016\t0\n-45.70139508530226\t0\n-45.3815974984045\t0\n-45.06179991150674\t0\n-44.742002324608976\t0\n-44.422204737711226\t0\n-44.10240715081346\t0\n-43.7826095639157\t0\n-43.46281197701795\t0\n-43.143014390120186\t0\n-42.82321680322243\t0\n-42.50341921632467\t0\n-42.18362162942691\t0\n-41.86382404252915\t0\n-41.544026455631396\t0\n-41.22422886873363\t0\n-40.90443128183587\t0\n-40.58463369493812\t0\n-40.264836108040356\t0\n-39.94503852114259\t0\n-39.625240934244836\t0\n-39.30544334734708\t0\n-38.98564576044932\t0\n-38.665848173551566\t0\n-38.3460505866538\t0\n-38.026252999756046\t0\n-37.70645541285829\t0\n-37.386657825960526\t0\n-37.06686023906276\t0\n-36.74706265216501\t0\n-36.42726506526725\t0\n-36.107467478369486\t0\n-35.78766989147173\t0\n-35.46787230457397\t0\n-35.14807471767622\t0\n-34.82827713077846\t0\n-34.508479543880696\t0\n-34.18868195698294\t0\n-33.86888437008518\t0\n-33.54908678318742\t0\n-33.229289196289656\t0\n-32.90949160939191\t0\n-32.58969402249414\t0\n-32.26989643559638\t0\n-31.950098848698623\t0\n-31.630301261800867\t0\n-31.31050367490311\t0\n-30.99070608800535\t0\n-30.67090850110759\t0\n-30.351110914209833\t0\n-30.031313327312073\t0\n-29.711515740414313\t0\n-29.391718153516557\t0\n-29.071920566618793\t0\n-28.752122979721037\t0\n-28.43232539282328\t0\n-28.112527805925517\t0\n-27.79273021902776\t0\n-27.472932632129996\t0\n-27.15313504523224\t0\n-26.833337458334483\t0\n-26.51353987143672\t0\n-26.193742284538963\t0\n-25.873944697641207\t0\n-25.554147110743443\t0\n-25.234349523845687\t0\n-24.914551936947937\t0\n-24.594754350050174\t0\n-24.274956763152417\t0\n-23.955159176254654\t0\n-23.635361589356897\t0\n-23.31556400245914\t0\n-22.995766415561377\t0\n-22.67596882866362\t0\n-22.356171241765857\t0\n-22.0363736548681\t0\n-21.716576067970344\t0\n-21.39677848107258\t0\n-21.076980894174824\t0\n-20.757183307277067\t0\n-20.437385720379304\t0\n-20.117588133481547\t0\n-19.797790546583784\t1\n-19.477992959686027\t0\n-19.15819537278827\t0\n-18.838397785890507\t0\n-18.51860019899275\t0\n-18.198802612094994\t1\n-17.87900502519723\t0\n-17.559207438299474\t0\n-17.23940985140171\t0\n-16.91961226450396\t0\n-16.599814677606204\t0\n-16.28001709070844\t0\n-15.960219503810684\t0\n-15.640421916912928\t1\n-15.320624330015164\t0\n-15.000826743117408\t0\n-14.681029156219644\t0\n-14.361231569321887\t0\n-14.041433982424131\t0\n-13.721636395526367\t0\n-13.40183880862861\t0\n-13.082041221730854\t0\n-12.76224363483309\t0\n-12.442446047935334\t0\n-12.12264846103757\t0\n-11.802850874139814\t0\n-11.483053287242058\t0\n-11.163255700344294\t0\n-10.843458113446538\t0\n-10.523660526548781\t0\n-10.203862939651017\t0\n-9.884065352753261\t0\n-9.564267765855497\t0\n-9.24447017895774\t0\n-8.924672592059984\t0\n-8.604875005162228\t0\n-8.285077418264471\t0\n-7.965279831366715\t0\n-7.645482244468951\t0\n-7.325684657571195\t0\n-7.005887070673431\t0\n-6.686089483775675\t0\n-6.366291896877918\t0\n-6.0464943099801545\t1\n-5.726696723082398\t0\n-5.4068991361846415\t0\n-5.087101549286878\t0\n-4.767303962389121\t2\n-4.447506375491358\t0\n-4.127708788593601\t0\n-3.8079112016958447\t1\n-3.488113614798081\t2\n-3.1683160279003246\t0\n-2.848518441002568\t0\n-2.5287208541048045\t0\n-2.208923267207048\t2\n-1.8891256803092844\t1\n-1.569328093411528\t1\n-1.2495305065137714\t2\n-0.9297329196160078\t6\n-0.6099353327182584\t10\n-0.2901377458205019\t9\n0.029659841077261717\t11\n0.3494574279750182\t16\n0.6692550148727818\t8\n0.9890526017705383\t4\n1.3088501886682948\t2\n1.6286477755660584\t3\n1.948445362463815\t0\n2.2682429493615714\t2\n2.588040536259335\t0\n2.9078381231570987\t1\n3.227635710054848\t2\n3.5474332969525975\t2\n3.8672308838503753\t2\n4.187028470748125\t0\n4.506826057645888\t0\n4.826623644543638\t0\n5.146421231441401\t0\n5.466218818339165\t0\n5.7860164052369285\t0\n6.105813992134678\t0\n6.4256115790324415\t1\n6.745409165930191\t0\n7.065206752827969\t0\n7.385004339725718\t1\n7.704801926623482\t1\n8.024599513521231\t0\n8.344397100418995\t0\n8.664194687316744\t0\n8.983992274214522\t0\n9.303789861112271\t1\n9.623587448010035\t0\n9.943385034907784\t0\n10.263182621805548\t0\n10.582980208703312\t1\n10.902777795601075\t0\n11.222575382498825\t0\n11.542372969396588\t0\n11.862170556294338\t0\n12.181968143192087\t0\n12.501765730089865\t0\n12.821563316987614\t0\n13.141360903885378\t0\n13.461158490783127\t0\n13.78095607768089\t0\n14.100753664578654\t0\n14.420551251476418\t0\n14.740348838374167\t0\n15.060146425271931\t0\n15.37994401216968\t0\n15.699741599067458\t0\n16.019539185965208\t0\n16.33933677286297\t0\n16.65913435976072\t0\n16.978931946658484\t0\n17.298729533556248\t0\n17.61852712045401\t0\n17.93832470735176\t0\n18.258122294249524\t0\n18.577919881147274\t0\n18.897717468045037\t0\n19.2175150549428\t0\n19.537312641840565\t0\n19.857110228738314\t0\n20.176907815636064\t0\n20.496705402533827\t0\n20.81650298943159\t0\n21.136300576329354\t0\n21.456098163227104\t0\n21.775895750124867\t0\n22.095693337022617\t0\n22.415490923920395\t0\n22.735288510818144\t0\n23.055086097715908\t0\n23.374883684613657\t0\n23.69468127151142\t0\n24.01447885840917\t0\n24.334276445306948\t0\n24.654074032204697\t0\n24.97387161910246\t0\n25.29366920600021\t0\n25.613466792897974\t0\n25.933264379795737\t0\n26.2530619666935\t0\n26.57285955359125\t0\n26.892657140489014\t0\n27.212454727386763\t0\n27.53225231428454\t0\n27.85204990118229\t0\n28.17184748808004\t0\n28.491645074977804\t0\n28.811442661875553\t0\n29.131240248773317\t0\n29.45103783567108\t0\n29.770835422568844\t0\n30.090633009466593\t0\n30.410430596364357\t0\n30.730228183262106\t0\n31.050025770159884\t0\n31.369823357057633\t0\n31.689620943955397\t0\n32.00941853085315\t0\n32.32921611775091\t0\n32.649013704648674\t0\n32.96881129154644\t0\n33.28860887844419\t0\n33.60840646534195\t0\n33.9282040522397\t0\n34.24800163913746\t0\n34.56779922603523\t0\n34.88759681293299\t0\n35.20739439983074\t0\n35.5271919867285\t0\n35.84698957362625\t0\n36.16678716052403\t0\n36.48658474742178\t0\n36.80638233431953\t0\n37.12617992121729\t0\n37.44597750811504\t0\n37.76577509501282\t0\n38.08557268191057\t0\n38.40537026880833\t0\n38.72516785570608\t0\n39.044965442603846\t0\n39.364763029501596\t0\n39.684560616399374\t0\n40.00435820329712\t0\n40.32415579019489\t0\n40.643953377092636\t0\n40.9637509639904\t0\n41.28354855088816\t0\n41.60334613778593\t0\n41.923143724683676\t0\n42.24294131158144\t0\n42.56273889847919\t0\n42.88253648537697\t0\n43.20233407227472\t0\n43.52213165917248\t0\n43.84192924607023\t0\n44.16172683296799\t0\n44.48152441986574\t0\n44.801322006763506\t0\n45.12111959366127\t0\n45.44091718055902\t0\n45.76071476745678\t0\n46.08051235435453\t0\n46.40030994125231\t0\n46.72010752815006\t0\n47.03990511504782\t0\n47.35970270194557\t0\n47.679500288843336\t0\n47.9992978757411\t0\n48.31909546263886\t0\n48.63889304953661\t0\n48.958690636434376\t0\n49.278488223332126\t0\n49.59828581022989\t0\n49.91808339712765\t0\n50.237880984025416\t0\n50.557678570923166\t0\n50.87747615782093\t0\n51.19727374471868\t0\n51.51707133161646\t0\n51.836868918514206\t0\n52.15666650541197\t0\n52.47646409230972\t0\n52.79626167920747\t0\n53.116059266105246\t0\n53.435856853002996\t0\n53.75565443990076\t0\n54.07545202679851\t0\n54.39524961369627\t0\n54.71504720059402\t0\n55.0348447874918\t0\n55.35464237438955\t0\n55.67443996128731\t0\n55.99423754818506\t0\n56.314035135082825\t0\n56.63383272198059\t0\n56.95363030887835\t0\n57.2734278957761\t0\n57.593225482673866\t0\n57.913023069571615\t0\n58.23282065646939\t0\n58.55261824336714\t0\n58.872415830264906\t0\n59.192213417162655\t0\n59.51201100406042\t0\n59.83180859095817\t0\n60.151606177855946\t0\n60.471403764753695\t0\n60.791201351651445\t0\n61.11099893854921\t0\n61.43079652544696\t0\n61.750594112344736\t0\n62.070391699242485\t0\n62.39018928614025\t0\n62.709986873038\t0\n63.02978445993576\t0\n63.349582046833525\t0\n63.66937963373129\t0\n63.98917722062904\t0\n64.3089748075268\t0\n64.62877239442454\t0\n64.94856998132232\t0\n65.26836756822007\t0\n65.58816515511785\t0\n65.9079627420156\t0\n66.22776032891335\t0\n66.5475579158111\t0\n66.86735550270888\t0\n67.18715308960662\t0\n67.50695067650437\t0\n67.82674826340215\t0\n68.1465458502999\t0\n68.46634343719765\t0\n68.78614102409543\t0\n69.10593861099315\t0\n69.42573619789093\t0\n69.7455337847887\t0\n70.06533137168645\t0\n70.3851289585842\t0\n70.70492654548195\t0\n71.02472413237973\t0\n71.34452171927751\t0\n71.66431930617523\t0\n71.98411689307301\t0\n72.30391447997076\t0\n72.62371206686853\t0\n72.94350965376628\t0\n73.26330724066403\t0\n73.58310482756181\t0\n73.90290241445956\t0\n74.22270000135731\t0\n74.54249758825509\t0\n74.86229517515284\t0\n75.18209276205062\t0\n75.50189034894834\t0\n75.82168793584611\t0\n76.14148552274389\t0\n76.46128310964164\t0\n76.78108069653939\t0\n77.10087828343714\t0\n77.42067587033492\t0\n77.74047345723264\t0\n78.06027104413042\t0\n78.3800686310282\t0\n78.69986621792594\t0\n79.0196638048237\t0\n79.33946139172144\t0\n79.65925897861922\t0\n79.979056565517\t0\n80.29885415241472\t0\n80.6186517393125\t0\n80.93844932621025\t0\n81.25824691310802\t0\n81.57804450000577\t0\n81.89784208690352\t0\n82.2176396738013\t0\n82.53743726069905\t0\n82.8572348475968\t0\n83.17703243449458\t0\n83.49683002139233\t0\n83.8166276082901\t0\n84.13642519518783\t0\n84.4562227820856\t0\n84.77602036898338\t0\n85.09581795588113\t0\n85.41561554277888\t0\n85.73541312967663\t0\n86.05521071657441\t0\n86.37500830347213\t0\n86.6948058903699\t0\n87.01460347726768\t0\n87.33440106416543\t0\n87.65419865106318\t0\n87.97399623796093\t0\n88.29379382485871\t0\n88.61359141175649\t0\n88.93338899865421\t0\n89.25318658555199\t0\n89.57298417244974\t0\n89.89278175934751\t0\n90.21257934624526\t0\n90.53237693314301\t0\n90.85217452004079\t0\n91.17197210693854\t0\n91.49176969383629\t0\n91.81156728073407\t0\n92.13136486763182\t0\n92.4511624545296\t0\n92.77096004142732\t0\n93.0907576283251\t0\n93.41055521522287\t0\n93.73035280212059\t0\n94.05015038901837\t0\n94.36994797591612\t0\n94.6897455628139\t0\n95.00954314971165\t0\n95.3293407366094\t0\n95.64913832350717\t0\n95.96893591040492\t0\n96.28873349730267\t0\n96.60853108420045\t0\n96.9283286710982\t0\n97.24812625799598\t0\n97.5679238448937\t1\n"},{"type":"TEXT","data":"zippedValues: Array[(Double, Long)] = Array((-62.01107201708796,1), (-61.691274430190205,0), (-61.37147684329244,0), (-61.051679256394685,0), (-60.73188166949693,0), (-60.412084082599165,0), (-60.09228649570141,0), (-59.77248890880365,0), (-59.45269132190589,0), (-59.13289373500813,0), (-58.813096148110375,0), (-58.49329856121261,0), (-58.173500974314855,0), (-57.8537033874171,0), (-57.533905800519335,0), (-57.21410821362158,0), (-56.89431062672382,0), (-56.57451303982606,0), (-56.2547154529283,0), (-55.934917866030545,0), (-55.61512027913278,0), (-55.295322692235025,0), (-54.97552510533727,0), (-54.655727518439505,0), (-54.33592993154175,0), (-54.01613234464399,0), (-53.69633475774623,0), (-53.37653717084847,0), (-53.056739583950716,0), (-52.73694199705295,0), (-52.417144410155196,0), ..."}]},"text":"val zippedValues = startValues.zip(counts)\ncase class HistRow(startPoint:Double,count:Long)\nval rowRDD = zippedValues.map( value => HistRow(value._1,value._2))\nval histDf = spark.createDataFrame(rowRDD)\nz.show(histDf)"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1570998409707_544539405","id":"20191013-202649_759003598","dateCreated":"2019-10-13T20:26:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14293","dateUpdated":"2019-10-13T20:29:23+0000"}],"name":"MMOD: Lab1","id":"2EPZ6XXN3","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}