{"paragraphs":[{"text":"class LinearCongruentGenerator(m: BigInt = BigInt(\"34359738368\"),\n                               k: BigInt = BigInt(\"152587890625\"),\n                               A0: BigInt = 999) extends Serializable {\n\n  var prevValue: BigInt = A0\n\n  def next: Double = {\n    val result: BigInt = (k * prevValue) % m\n    prevValue = result\n    result.toDouble / m.toDouble\n  }\n}\n\nval random = new LinearCongruentGenerator","user":"anonymous","dateUpdated":"2019-10-01T11:21:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class LinearCongruentGenerator\nrandom: LinearCongruentGenerator = LinearCongruentGenerator@47f6504c\n"}]},"apps":[],"jobName":"paragraph_1569919552627_268489370","id":"20191001-084552_364857475","dateCreated":"2019-10-01T08:45:52+0000","dateStarted":"2019-10-01T11:21:26+0000","dateFinished":"2019-10-01T11:21:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:27676"},{"text":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\n\nval N = 1000000\n\nval df = spark.createDataFrame(\n    spark.sparkContext.parallelize((0 until N).map(i => (i, random.next))).map(t => Row(t._1, t._2)), \n    StructType(\n        Seq(\n            StructField(\"id\", DataTypes.IntegerType, false), \n            StructField(\"value\", DataTypes.DoubleType, false)\n            )\n    )\n)","user":"anonymous","dateUpdated":"2019-10-01T11:21:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\nN: Int = 1000000\ndf: org.apache.spark.sql.DataFrame = [id: int, value: double]\n"}]},"apps":[],"jobName":"paragraph_1569919629176_224813278","id":"20191001-084709_1538422238","dateCreated":"2019-10-01T08:47:09+0000","dateStarted":"2019-10-01T11:21:37+0000","dateFinished":"2019-10-01T11:21:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27677"},{"text":"// df.groupBy(\"value\").count.count","user":"anonymous","dateUpdated":"2019-10-01T11:21:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1569921079693_-672940362","id":"20191001-091119_1929410209","dateCreated":"2019-10-01T09:11:19+0000","dateStarted":"2019-10-01T11:21:39+0000","dateFinished":"2019-10-01T11:21:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27678"},{"text":"// z.show(df.groupBy(\"value\").count.sort('count.desc))","user":"anonymous","dateUpdated":"2019-10-01T11:21:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"value":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"value","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1569919631657_1990853315","id":"20191001-084711_15939298","dateCreated":"2019-10-01T08:47:11+0000","dateStarted":"2019-10-01T11:21:39+0000","dateFinished":"2019-10-01T11:21:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27679"},{"text":"import org.apache.spark.sql.types.IntegerType\nval K = 100 // number of intervals\nz.show(df.withColumn(\"int_id\", ('value * K).cast(IntegerType)).groupBy(\"int_id\").count)","user":"anonymous","dateUpdated":"2019-10-01T11:21:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"int_id":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"int_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"int_id\tcount\n31\t9979\n85\t9960\n65\t10062\n53\t9816\n78\t9955\n34\t9911\n81\t9934\n28\t10118\n76\t10000\n27\t9956\n26\t9992\n44\t9975\n12\t9972\n91\t9938\n22\t9986\n93\t9970\n47\t10067\n1\t10133\n52\t9919\n13\t9983\n86\t10033\n16\t10012\n6\t10009\n3\t9857\n40\t9933\n20\t10122\n94\t10130\n57\t10140\n54\t10094\n96\t10046\n48\t10168\n5\t10000\n19\t10006\n92\t10043\n64\t10040\n41\t9854\n15\t10006\n43\t10087\n37\t10007\n61\t9974\n88\t9997\n9\t10040\n17\t9674\n72\t9972\n35\t9971\n59\t9964\n4\t10069\n55\t9835\n8\t9924\n23\t10138\n39\t10064\n49\t10146\n7\t10138\n84\t9916\n87\t10030\n51\t9691\n69\t9883\n97\t10035\n63\t10111\n77\t10089\n10\t10028\n50\t10023\n45\t9946\n38\t10176\n82\t10066\n80\t9984\n25\t9949\n73\t10064\n24\t10011\n70\t10064\n62\t10127\n95\t9898\n29\t9948\n21\t9974\n98\t9861\n60\t9964\n90\t10075\n32\t9836\n75\t10016\n56\t10036\n58\t9924\n11\t10000\n33\t9909\n83\t9909\n71\t9991\n68\t10164\n14\t9868\n42\t10020\n79\t9841\n2\t9880\n30\t10013\n99\t10121\n66\t10122\n67\t9846\n46\t10116\n0\t10143\n18\t10072\n74\t9875\n36\t10228\n89\t10038\n"},{"type":"TEXT","data":"import org.apache.spark.sql.types.IntegerType\nK: Int = 100\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=0","http://172.17.0.2:4040/jobs/job?id=1","http://172.17.0.2:4040/jobs/job?id=2","http://172.17.0.2:4040/jobs/job?id=3","http://172.17.0.2:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1569919928761_2031522167","id":"20191001-085208_579427695","dateCreated":"2019-10-01T08:52:08+0000","dateStarted":"2019-10-01T11:21:40+0000","dateFinished":"2019-10-01T11:21:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27680"},{"text":"val M = df.select(avg('value)).first.getDouble(0)\nval M2 = scala.math.pow(M, 2)\nval D = df.select((pow('value, 2) - M2).as(\"diff\")).select(avg('diff)).first.getDouble(0)","user":"anonymous","dateUpdated":"2019-10-01T11:21:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"M: Double = 0.4999906065594074\nM2: Double = 0.24999060664764414\nD: Double = 0.08335051769541778\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=5","http://172.17.0.2:4040/jobs/job?id=6"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1569922770454_1898422235","id":"20191001-093930_847132398","dateCreated":"2019-10-01T09:39:30+0000","dateStarted":"2019-10-01T11:21:44+0000","dateFinished":"2019-10-01T11:21:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27681"},{"text":"val df2 = df.withColumn(\"id2\", 'id + 5).withColumnRenamed(\"value\", \"value2\").drop(\"id\")\nval joined = df.join(df2, df.col(\"id\") === df2.col(\"id2\"))\nval R = joined.withColumn(\"mul\", 'value * 'value2).select((avg('mul) * 12) - 3).first.getDouble(0)","user":"anonymous","dateUpdated":"2019-10-01T11:21:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df2: org.apache.spark.sql.DataFrame = [value2: double, id2: int]\njoined: org.apache.spark.sql.DataFrame = [id: int, value: double ... 2 more fields]\nR: Double = 0.0019007082184892\n"}]},"apps":[],"jobName":"paragraph_1569926032474_-102907703","id":"20191001-103352_1088882450","dateCreated":"2019-10-01T10:33:52+0000","dateStarted":"2019-10-01T11:21:47+0000","dateFinished":"2019-10-01T11:21:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27683","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=7"],"interpreterSettingId":"spark"}}},{"text":"","user":"anonymous","dateUpdated":"2019-10-01T10:55:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1569926063619_-1752310443","id":"20191001-103423_951730408","dateCreated":"2019-10-01T10:34:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27684"}],"name":"MMOD: Lab1","id":"2EN54C5M4","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}